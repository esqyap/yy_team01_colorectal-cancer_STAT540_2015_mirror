# LIMMA_analysis: (normal-C+normal-H) vs cancer
Beryl Zhuang  
Sunday, April 05, 2015  


#### Differential methylation analysis comparing normal-c and normal-H


LIMMA codes are writen by Ka Ming.



```r
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
## 
## The following object is masked from 'package:stats':
## 
##     filter
## 
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

```r
library(limma)
library(ggplot2)
```


```r
source("../../rscripts/helper_functions.R")
```



```r
# codes from Ka Ming

# loading the norm. CGI.
M.norm.CGI.path <- "../../data/GSE48684_raw_filtered.m.norm.cgi.Rdata"
load(M.norm.CGI.path)
M.norm.CGI.path <- na.omit(M.norm.CGI.path)

# load the metadata
metadata.path <- "../../data/metadata.Rdata"
load(metadata.path)

# sanity check
head(M.norm.CGI)
```

```
##                          GSM1183439  GSM1183440 GSM1183441 GSM1183442
## chr1:10003165-10003585   -2.6552923 -2.59856415 -2.5445386 -2.5589572
## chr1:1002663-1005318     -0.4691256 -0.09143954 -0.2533638 -0.2153825
## chr1:100315420-100316009 -3.2051837 -3.28066606 -3.1908783 -3.3171275
## chr1:100435297-100436070 -2.6509063 -2.53842308 -2.3740902 -2.6930074
## chr1:100503482-100504404 -2.5912106 -2.61793251 -2.5333289 -2.6985588
## chr1:10057121-10058108   -1.8793069 -1.60397303 -1.9452079 -1.4107345
##                           GSM1183443 GSM1183444 GSM1183445 GSM1183446
## chr1:10003165-10003585   -2.55737653 -2.5826043 -2.4911736  -2.554945
## chr1:1002663-1005318     -0.09556418 -0.1394251 -0.9472826  -0.156273
## chr1:100315420-100316009 -3.44138495 -3.2638314 -3.5903340  -3.175695
## chr1:100435297-100436070 -2.58548225 -2.6448828 -2.8978879  -2.530715
## chr1:100503482-100504404 -2.77076081 -2.7414266 -2.8660505  -2.676452
## chr1:10057121-10058108   -1.89517507 -2.1822275 -2.7476044  -1.366660
##                          GSM1183447 GSM1183448 GSM1183449 GSM1183450
## chr1:10003165-10003585   -2.8167373 -2.6015900 -2.7326851  -2.687569
## chr1:1002663-1005318     -0.9355684 -0.5594806 -0.9262892  -1.276605
## chr1:100315420-100316009 -3.7200904 -3.4311690 -3.5356330  -3.462461
## chr1:100435297-100436070 -2.9591127 -2.7513380 -2.9045330  -2.883730
## chr1:100503482-100504404 -2.7442432 -2.7249048 -2.7322991  -2.698558
## chr1:10057121-10058108   -2.7962893 -1.6385844 -2.9030710  -3.324011
##                          GSM1183451 GSM1183452 GSM1183453 GSM1183454
## chr1:10003165-10003585    -2.739601 -2.3145316 -2.4420093 -2.5683021
## chr1:1002663-1005318      -0.547058  0.2199845  0.1354862 -0.1364899
## chr1:100315420-100316009  -3.476851 -3.2057071 -3.1883463 -3.4435985
## chr1:100435297-100436070  -3.013518 -1.7599024 -1.9642126 -2.5990879
## chr1:100503482-100504404  -2.841048 -2.3777453 -2.4337830 -2.5278606
## chr1:10057121-10058108    -2.548544 -1.3898947 -1.7715518 -2.2878826
##                          GSM1183455 GSM1183456 GSM1183457 GSM1183458
## chr1:10003165-10003585   -2.5611068 -2.6112883 -2.9289910 -2.5701139
## chr1:1002663-1005318      0.0855106 -0.1495479 -0.2503045 -0.8035391
## chr1:100315420-100316009 -3.5442221 -3.3321487 -3.4719609 -3.3151074
## chr1:100435297-100436070 -2.9532561 -2.5944388 -2.7733070 -2.8305448
## chr1:100503482-100504404 -2.7577497 -2.6674068 -2.7293921 -2.6465480
## chr1:10057121-10058108   -1.8906351 -2.2961952 -0.7416368 -2.7446878
##                          GSM1183459 GSM1183460 GSM1183461 GSM1183462
## chr1:10003165-10003585   -2.5928901 -2.3889526 -2.6460887 -2.7231261
## chr1:1002663-1005318     -0.0978623 -0.5153299 -0.1302912 -0.2164913
## chr1:100315420-100316009 -3.1202442 -3.1034921 -3.3016168 -3.4521085
## chr1:100435297-100436070 -2.3362214 -2.3185678 -2.5481766 -2.5349049
## chr1:100503482-100504404 -2.6162707 -2.3970941 -2.7532512 -2.7130206
## chr1:10057121-10058108   -2.2802288 -2.7551910 -2.5061829 -0.4842863
##                          GSM1183463 GSM1183464 GSM1183465 GSM1183466
## chr1:10003165-10003585   -2.5491017 -2.4576876 -2.6634236 -2.6269710
## chr1:1002663-1005318      0.1777277  0.2527131  0.1042947 -0.4701124
## chr1:100315420-100316009 -3.2860087 -3.2898758 -3.2739430 -3.3949594
## chr1:100435297-100436070 -2.4025642 -2.3717973 -2.2822308 -2.6972064
## chr1:100503482-100504404 -2.6531850 -2.6213044 -2.6589155 -2.8621837
## chr1:10057121-10058108   -1.7501278 -0.9031143 -1.4175589 -2.5515072
##                          GSM1183467 GSM1183468 GSM1183469 GSM1183470
## chr1:10003165-10003585   -2.5975998 -2.5412295 -2.4850925 -2.4145797
## chr1:1002663-1005318     -0.1106584 -0.3974871 -0.1186928 -0.4646606
## chr1:100315420-100316009 -3.3165319 -3.2531491 -3.0885286 -3.3201661
## chr1:100435297-100436070 -2.7201684 -2.6577729 -2.6383212 -2.6271861
## chr1:100503482-100504404 -2.7140042 -2.6688105 -2.6891018 -2.5954421
## chr1:10057121-10058108   -1.9689749 -2.1921074 -2.1734550 -2.1911826
##                          GSM1183471 GSM1183472  GSM1183473 GSM1183474
## chr1:10003165-10003585   -2.5213979  -2.466313 -2.55134704 -2.4765215
## chr1:1002663-1005318     -0.2727839  -0.204244  0.04854337 -0.3592211
## chr1:100315420-100316009 -3.2953992  -3.218619 -3.28942467 -3.4000418
## chr1:100435297-100436070 -2.5079133  -2.562802 -2.69858064 -2.6323302
## chr1:100503482-100504404 -2.6814858  -2.463127 -2.67413839 -2.8827299
## chr1:10057121-10058108   -1.9749580  -2.118518 -1.98687058 -1.6137291
##                          GSM1183475 GSM1183476 GSM1183477 GSM1183478
## chr1:10003165-10003585   -2.5553456 -2.5007390 -2.5346772 -2.5382355
## chr1:1002663-1005318     -0.2639951 -0.3881833 -0.1877652 -0.2008505
## chr1:100315420-100316009 -3.3787453 -3.3049143 -3.2620533 -3.2547827
## chr1:100435297-100436070 -2.6092785 -2.6791712 -2.6729198 -2.6679753
## chr1:100503482-100504404 -2.7651728 -2.7097997 -2.7011483 -2.6685389
## chr1:10057121-10058108   -1.9800005 -2.2907397 -1.6842134 -2.2742424
##                           GSM1183479 GSM1183480 GSM1183481 GSM1183482
## chr1:10003165-10003585   -2.78934539 -2.4393726  -2.470685 -2.4599626
## chr1:1002663-1005318      0.03098998 -0.3446402  -0.356047 -0.2735848
## chr1:100315420-100316009 -3.22150296 -3.2752470  -3.283137 -3.2123623
## chr1:100435297-100436070 -2.49583434 -2.6676062  -2.679606 -2.6550079
## chr1:100503482-100504404 -2.66726367 -2.8328728  -2.624475 -2.7429252
## chr1:10057121-10058108   -1.90776652 -2.5284930  -2.390040 -2.4086346
##                          GSM1183483  GSM1183484 GSM1183485 GSM1183486
## chr1:10003165-10003585   -2.6406160 -2.70045313 -2.7033185 -2.6432762
## chr1:1002663-1005318      0.1419676  0.02287766 -0.2400202 -0.0466823
## chr1:100315420-100316009 -3.2889347 -3.48242760 -3.2918360 -3.3131523
## chr1:100435297-100436070 -2.4959864 -2.78518605 -2.5886347 -2.5103397
## chr1:100503482-100504404 -2.8480882 -2.70227145 -2.8255920 -2.5938201
## chr1:10057121-10058108   -2.1335111 -2.58234107 -1.7365505 -2.1008323
##                          GSM1183487 GSM1183488 GSM1183489 GSM1183490
## chr1:10003165-10003585   -2.1723282 -2.4762976 -2.7209445 -2.6450045
## chr1:1002663-1005318      0.3671142 -0.2484297  0.1206241  0.1053612
## chr1:100315420-100316009 -2.8700148 -3.1976002 -3.0185030 -2.9115272
## chr1:100435297-100436070 -2.0898900 -2.6466377 -2.3003844 -2.3822229
## chr1:100503482-100504404 -2.3997197 -2.7176038 -2.5165885 -2.6060197
## chr1:10057121-10058108   -1.7340586 -2.0591488 -2.0783172 -1.6675826
##                          GSM1183491 GSM1183492 GSM1183493 GSM1183494
## chr1:10003165-10003585   -2.6654612 -2.3219709 -2.4483201 -2.5511022
## chr1:1002663-1005318      0.3462601  0.4469207  0.1254926 -0.5048053
## chr1:100315420-100316009 -3.1088263 -2.9417798 -3.4914174 -3.3202710
## chr1:100435297-100436070 -2.3348525 -2.0809495 -2.4237925 -2.4554246
## chr1:100503482-100504404 -2.6348955 -2.4477740 -2.7663400 -2.9570593
## chr1:10057121-10058108   -2.0751118 -1.8962422 -1.7759178 -2.1877155
##                           GSM1183495  GSM1183496  GSM1183497  GSM1183498
## chr1:10003165-10003585   -2.63486408 -2.48162177 -2.47640016 -2.58026479
## chr1:1002663-1005318     -0.06303079 -0.02946225 -0.09298967 -0.08300383
## chr1:100315420-100316009 -3.30801504 -3.18349564 -3.32868542 -3.30487740
## chr1:100435297-100436070 -2.55596834 -2.52263929 -2.71459787 -2.58571296
## chr1:100503482-100504404 -2.68080449 -2.76371740 -2.82548106 -2.97470935
## chr1:10057121-10058108   -1.83718920 -2.17762440 -2.30781157 -2.10909408
##                           GSM1183499 GSM1183500 GSM1183501 GSM1183502
## chr1:10003165-10003585   -2.63209567 -2.4744933 -2.4949798 -2.5833351
## chr1:1002663-1005318     -0.03106036 -0.3583119 -0.3324479 -0.2687182
## chr1:100315420-100316009 -3.34801905 -3.3203624 -3.2989031 -3.2702818
## chr1:100435297-100436070 -2.73638456 -2.6032170 -2.6614142 -2.7622146
## chr1:100503482-100504404 -2.73326044 -2.7836071 -2.6894563 -2.7985445
## chr1:10057121-10058108   -2.27761366 -2.0391860 -2.5430220 -2.3298607
##                          GSM1183503 GSM1183504 GSM1183505 GSM1183506
## chr1:10003165-10003585   -2.3760920 -2.5018222 -2.5406260 -2.6798983
## chr1:1002663-1005318     -0.5727622 -0.5142741 -0.3024174 -0.7474327
## chr1:100315420-100316009 -3.5542411 -3.2108034 -3.3840248 -3.5504974
## chr1:100435297-100436070 -2.6699468 -2.6373828 -2.6761145 -2.9711555
## chr1:100503482-100504404 -2.6357915 -2.6687809 -2.7204119 -2.8171362
## chr1:10057121-10058108   -2.4608661 -2.5729041 -2.3695044 -2.8156203
##                          GSM1183507 GSM1183508 GSM1183509 GSM1183510
## chr1:10003165-10003585   -2.4892827 -2.8071124 -2.6441459 -2.5450091
## chr1:1002663-1005318     -0.6555263 -0.6368511 -0.5938308 -0.5133373
## chr1:100315420-100316009 -3.5385598 -3.6574768 -3.4092673 -3.3552417
## chr1:100435297-100436070 -3.0219965 -3.0268029 -2.7734492 -2.6306042
## chr1:100503482-100504404 -2.8428973 -2.8916099 -2.7695231 -2.5695898
## chr1:10057121-10058108   -2.5254960 -2.3954471 -2.8763173 -2.8564190
##                          GSM1183511 GSM1183512 GSM1183513   GSM1183514
## chr1:10003165-10003585   -2.3345401 -2.4611793 -2.5232826 -2.794565724
## chr1:1002663-1005318     -0.5646612 -0.6593965 -0.3996432 -0.893026075
## chr1:100315420-100316009 -3.3974549 -3.4518730 -3.3672605 -3.590974285
## chr1:100435297-100436070 -2.6486824 -3.0160474 -2.5688085 -2.871634800
## chr1:100503482-100504404 -2.8023253 -2.8171447 -2.6757521 -2.839093719
## chr1:10057121-10058108   -2.1076040 -2.8274641 -2.5582427 -0.004961779
##                          GSM1183515 GSM1183516  GSM1183517 GSM1183518
## chr1:10003165-10003585   -2.5574941 -2.4817320 -2.70980738 -2.4192976
## chr1:1002663-1005318      0.1908337 -0.3539109 -1.25742650 -0.2876498
## chr1:100315420-100316009 -3.1601333 -3.3948670 -3.39826153 -3.1621329
## chr1:100435297-100436070 -2.6326338 -2.8575446 -2.81982492 -2.5290203
## chr1:100503482-100504404 -2.7675520 -2.7245740 -2.86439386 -2.5466905
## chr1:10057121-10058108   -2.7167976 -2.4120587  0.02238012 -2.2057753
##                          GSM1183519 GSM1183520 GSM1183521 GSM1183522
## chr1:10003165-10003585   -2.8827217  -2.516365 -2.4537406 -2.6946777
## chr1:1002663-1005318     -0.3800922   0.487411 -0.1899291 -0.6922016
## chr1:100315420-100316009 -3.4278863  -3.180156 -3.3113328 -3.2982204
## chr1:100435297-100436070 -2.7879821  -2.160308 -2.7512474 -2.8967630
## chr1:100503482-100504404 -2.5341330  -2.466457 -2.7391940 -2.9843558
## chr1:10057121-10058108   -2.7943131  -1.627597 -2.6084962 -2.7768410
##                          GSM1183523 GSM1183524 GSM1183525 GSM1183526
## chr1:10003165-10003585   -2.4622112 -2.5451917 -2.6681450 -2.8270665
## chr1:1002663-1005318     -0.3450193 -0.4116018  0.1524643 -0.9742143
## chr1:100315420-100316009 -3.5347077 -3.3356859 -3.2475622 -3.6032944
## chr1:100435297-100436070 -2.7015844 -2.6075023 -2.4573471 -2.9766122
## chr1:100503482-100504404 -2.7011248 -2.5565389 -2.7428883 -2.8149033
## chr1:10057121-10058108   -2.3584792 -2.3597911 -1.9721684 -3.0843057
##                          GSM1183527  GSM1183528 GSM1183529  GSM1183530
## chr1:10003165-10003585    -2.715084 -2.51442884 -2.5722132 -2.51044935
## chr1:1002663-1005318      -1.052124 -0.07902266 -0.1090344 -0.08058042
## chr1:100315420-100316009  -3.577829 -3.25446329 -3.3411582 -3.40226436
## chr1:100435297-100436070  -3.096443 -2.51894210 -2.5145817 -2.78800177
## chr1:100503482-100504404  -2.786104 -2.52975089 -2.6832643 -2.61647446
## chr1:10057121-10058108    -2.856401 -2.35051733 -2.0999465 -2.45045802
##                          GSM1183531 GSM1183532 GSM1183533 GSM1183534
## chr1:10003165-10003585   -2.5230189 -2.4772421 -2.5054475 -2.5991168
## chr1:1002663-1005318     -0.7695092 -0.9591101 -0.5369419 -0.5766602
## chr1:100315420-100316009 -3.3759884 -3.5681969 -3.2956107 -3.3664893
## chr1:100435297-100436070 -2.7818569 -2.8156503 -2.5494621 -2.6290269
## chr1:100503482-100504404 -2.6662381 -2.7690945 -2.5586073 -2.7199332
## chr1:10057121-10058108   -2.6505661 -2.6469958 -2.2942003 -2.6646535
##                          GSM1183535 GSM1183536 GSM1183537 GSM1183538
## chr1:10003165-10003585    -2.363892  -2.666929  -2.616571 -2.5416443
## chr1:1002663-1005318      -0.154614  -1.045520  -1.254954 -0.8628501
## chr1:100315420-100316009  -3.383797  -3.531605  -3.549230 -3.4468167
## chr1:100435297-100436070  -2.777329  -2.977179  -2.886160 -2.7070430
## chr1:100503482-100504404  -2.684621  -2.946696  -2.937330 -2.7255946
## chr1:10057121-10058108    -2.439123  -1.864672  -2.005083 -2.9946131
##                          GSM1183539 GSM1183540 GSM1183541 GSM1183542
## chr1:10003165-10003585   -2.8752842 -2.4306625 -2.5951367  -2.676305
## chr1:1002663-1005318     -0.5308050  0.2092777 -0.1439707  -1.074767
## chr1:100315420-100316009 -3.5223805 -3.2474810 -3.1633167  -3.499562
## chr1:100435297-100436070 -2.7828174 -2.6042976 -2.3120103  -2.978451
## chr1:100503482-100504404 -2.9606268 -2.6586909 -2.6340278  -3.017156
## chr1:10057121-10058108   -0.8160312 -1.7308273 -2.5610825  -2.911221
##                          GSM1183543  GSM1183544 GSM1183545 GSM1183546
## chr1:10003165-10003585   -2.4328712 -2.68895993 -2.4035817 -2.7173873
## chr1:1002663-1005318     -0.5943623 -0.04813778  0.3884715 -0.3234209
## chr1:100315420-100316009 -3.3082008 -3.19362168 -3.1150482 -3.4909309
## chr1:100435297-100436070 -2.7679585 -2.45400458 -2.1515453 -2.6983911
## chr1:100503482-100504404 -2.5032138 -2.69788563 -2.6480267 -2.9672095
## chr1:10057121-10058108   -2.8442728 -1.89665624 -1.8706002 -2.0210757
##                          GSM1183547  GSM1183548 GSM1183549 GSM1183550
## chr1:10003165-10003585   -2.4708077 -2.67047241  -2.873039  -2.902766
## chr1:1002663-1005318     -0.1919004 -0.05228926  -1.225704  -1.020126
## chr1:100315420-100316009 -3.4013430 -3.30489431  -3.534048  -3.648111
## chr1:100435297-100436070 -2.6156074 -2.37281582  -3.085966  -2.986475
## chr1:100503482-100504404 -2.7828367 -2.67066895  -3.019369  -2.945886
## chr1:10057121-10058108   -2.2382613 -2.38875900  -2.206652  -2.058766
##                          GSM1183551 GSM1183552 GSM1183553  GSM1183554
## chr1:10003165-10003585   -2.6086813 -2.2954377 -2.4534002 -2.59945570
## chr1:1002663-1005318     -0.4032427  0.3948961  0.1173246  0.01771181
## chr1:100315420-100316009 -3.4765112 -3.0633456 -3.2935863 -3.26522873
## chr1:100435297-100436070 -2.6783351 -2.0686436 -2.4689794 -2.49531811
## chr1:100503482-100504404 -2.9638341 -2.4317759 -2.6365286 -2.67921463
## chr1:10057121-10058108   -2.3911001 -2.0523751 -1.7506630 -2.19764846
##                          GSM1183555  GSM1183556 GSM1183557   GSM1183558
## chr1:10003165-10003585   -2.7170612 -2.47360455 -2.7437807 -2.793726717
## chr1:1002663-1005318      0.0363121  0.02016923 -0.5060306 -1.417894319
## chr1:100315420-100316009 -3.5089492 -3.36980796 -3.3420403 -3.535314747
## chr1:100435297-100436070 -2.5036881 -2.75306404 -2.7442860 -3.275508203
## chr1:100503482-100504404 -2.6449797 -2.76934714 -2.6517998 -2.940411823
## chr1:10057121-10058108   -2.1389980 -2.56401695 -2.8584225 -0.001879325
##                           GSM1183559 GSM1183560 GSM1183561 GSM1235135
## chr1:10003165-10003585   -2.57914633 -2.8330552 -2.7309010 -2.6811757
## chr1:1002663-1005318     -0.04596533 -1.1547271 -0.8737399 -0.8261102
## chr1:100315420-100316009 -3.32159900 -3.7492971 -3.5794866 -3.4431519
## chr1:100435297-100436070 -2.52344354 -2.9957279 -2.7698383 -2.7759642
## chr1:100503482-100504404 -2.64300275 -3.0614550 -2.7066204 -2.8489858
## chr1:10057121-10058108   -1.96268277 -0.5575545 -1.7797307 -2.4014718
##                          GSM1235136 GSM1235137 GSM1235138 GSM1235139
## chr1:10003165-10003585   -2.6477766  -2.702564 -2.8023263 -2.4478487
## chr1:1002663-1005318     -0.3844503  -0.483281 -0.8482104 -0.3493395
## chr1:100315420-100316009 -3.4730226  -3.451509 -3.5055528 -3.3486040
## chr1:100435297-100436070 -2.7160374  -2.808582 -2.9682315 -2.6851538
## chr1:100503482-100504404 -2.8288185  -2.773447 -2.8228641 -2.7326488
## chr1:10057121-10058108   -1.7369457  -2.186193 -2.3280194 -2.2730317
##                          GSM1235140 GSM1235141 GSM1235142  GSM1235143
## chr1:10003165-10003585    -2.828660  -2.676493  -2.692334 -2.90152090
## chr1:1002663-1005318      -1.018976  -0.542397  -0.819848 -0.03415505
## chr1:100315420-100316009  -3.536803  -3.498916  -3.517102 -3.66291211
## chr1:100435297-100436070  -2.844221  -2.951094  -2.949362 -2.93604861
## chr1:100503482-100504404  -2.736433  -2.908117  -2.776179 -3.05398469
## chr1:10057121-10058108    -2.728394  -2.462111  -2.916486 -2.08641546
##                          GSM1235144 GSM1235145 GSM1235146 GSM1235147
## chr1:10003165-10003585    -2.862507 -2.5671695 -2.7707534 -2.6113458
## chr1:1002663-1005318      -1.429965 -0.3208506 -0.6404117 -0.7149859
## chr1:100315420-100316009  -3.735792 -3.5761870 -3.6200129 -3.4897598
## chr1:100435297-100436070  -3.105051 -2.6148847 -2.7674711 -2.5894137
## chr1:100503482-100504404  -2.908989 -2.8832492 -2.9253187 -2.7715724
## chr1:10057121-10058108    -1.103073 -2.0376414 -2.7294505 -2.3116782
##                          GSM1235148 GSM1235149 GSM1235150 GSM1235151
## chr1:10003165-10003585    -2.794790 -2.5643987  -2.626196 -2.3914945
## chr1:1002663-1005318      -0.195880 -0.8946123  -0.499279 -0.3712183
## chr1:100315420-100316009  -3.571170 -3.4136682  -3.344802 -3.6347130
## chr1:100435297-100436070  -2.791283 -2.8516547  -2.659318 -2.8817924
## chr1:100503482-100504404  -2.864650 -2.8154332  -2.801233 -2.7130548
## chr1:10057121-10058108    -2.507433 -2.3902709  -2.394794 -2.2583082
##                          GSM1235152 GSM1235153 GSM1235154 GSM1235155
## chr1:10003165-10003585   -2.6829868 -2.5431050 -2.6734087 -2.8229434
## chr1:1002663-1005318     -0.6720619 -0.3095247 -0.3535083 -0.9630747
## chr1:100315420-100316009 -3.6281184 -3.3301228 -3.3366841 -3.2905880
## chr1:100435297-100436070 -2.9513623 -2.6508038 -2.9213792 -2.8662826
## chr1:100503482-100504404 -2.7519088 -2.7644744 -2.8670847 -2.9335138
## chr1:10057121-10058108   -2.9960025 -2.3454842 -2.5402733 -2.8436313
##                          GSM1235156 GSM1235157 GSM1235158
## chr1:10003165-10003585   -2.5337367  -2.632813  -2.607099
## chr1:1002663-1005318     -0.6739876  -1.352517  -1.108535
## chr1:100315420-100316009 -3.4911129  -3.388591  -3.493868
## chr1:100435297-100436070 -2.6590959  -3.047235  -3.056798
## chr1:100503482-100504404 -2.7005638  -2.850698  -2.891250
## chr1:10057121-10058108   -2.5902250  -3.121232  -2.849576
```

```r
head(metadata)
```

```
##               group                                title geo_accession
## GSM1183439 normal-H Genomic DNA from normal individual 1    GSM1183439
## GSM1183440 normal-H Genomic DNA from normal individual 2    GSM1183440
## GSM1183441 normal-H Genomic DNA from normal individual 3    GSM1183441
## GSM1183442 normal-H Genomic DNA from normal individual 4    GSM1183442
## GSM1183443 normal-H Genomic DNA from normal individual 5    GSM1183443
## GSM1183444 normal-H Genomic DNA from normal individual 6    GSM1183444
##                       tissue colon_region gender stage
## GSM1183439 colorectal mucosa        colon   male  <NA>
## GSM1183440 colorectal mucosa        colon   male  <NA>
## GSM1183441 colorectal mucosa        colon female  <NA>
## GSM1183442 colorectal mucosa        colon   male  <NA>
## GSM1183443 colorectal mucosa        colon   male  <NA>
## GSM1183444 colorectal mucosa        colon   male  <NA>
```

```r
# function to perform limma to generate top table
limmaTopTables <- function(dat, des, file_name){
	myFit <- lmFit(dat, des)
	myEbFit <- eBayes(myFit)
	
	for (coeff in colnames(myEbFit$coefficients)[-1]){
		myTopTable <- topTable(myEbFit, number=nrow(dat), coef=c(coeff))
		
		save(myTopTable, file=file_name)
	}
}

# reorder factor level for `group`
metadata$group <- factor(metadata$group, levels=c("normal-H", "normal-C", "cancer", "adenoma"))
```



Subset the data and only keep normal-C and normal-H groups.
The design matrix is built only by normal-C and normal-H

```r
goal <- "Normal_vs_cancer"

group_names <- c("normal-H","normal-C", "cancer")
# design matrix for limma on group
des <- metadata[which(metadata$group %in% group_names), ] %>% droplevels()
# group normal-H and normal-C together
des$new_group <- "normal"
des$new_group[which(des$group == "cancer")] <- "cancer"

desMat.group <- model.matrix(~new_group, des)
desMat.group
```

```
##            (Intercept) new_groupnormal
## GSM1183439           1               1
## GSM1183440           1               1
## GSM1183441           1               1
## GSM1183442           1               1
## GSM1183443           1               1
## GSM1183444           1               1
## GSM1183453           1               0
## GSM1183454           1               0
## GSM1183455           1               0
## GSM1183456           1               0
## GSM1183457           1               0
## GSM1183458           1               0
## GSM1183459           1               0
## GSM1183460           1               0
## GSM1183461           1               0
## GSM1183462           1               0
## GSM1183463           1               0
## GSM1183464           1               0
## GSM1183465           1               0
## GSM1183466           1               0
## GSM1183467           1               1
## GSM1183468           1               1
## GSM1183469           1               1
## GSM1183470           1               1
## GSM1183471           1               1
## GSM1183472           1               1
## GSM1183473           1               1
## GSM1183474           1               1
## GSM1183475           1               1
## GSM1183476           1               1
## GSM1183477           1               1
## GSM1183478           1               1
## GSM1183479           1               1
## GSM1183480           1               1
## GSM1183481           1               1
## GSM1183482           1               1
## GSM1183483           1               1
## GSM1183484           1               1
## GSM1183485           1               1
## GSM1183486           1               1
## GSM1183487           1               1
## GSM1183488           1               1
## GSM1183489           1               1
## GSM1183490           1               1
## GSM1183491           1               1
## GSM1183492           1               1
## GSM1183493           1               1
## GSM1183494           1               1
## GSM1183495           1               1
## GSM1183496           1               1
## GSM1183497           1               1
## GSM1183498           1               1
## GSM1183499           1               1
## GSM1183500           1               1
## GSM1183501           1               1
## GSM1183512           1               0
## GSM1183513           1               0
## GSM1183514           1               0
## GSM1183515           1               0
## GSM1183516           1               0
## GSM1183517           1               0
## GSM1183518           1               0
## GSM1183519           1               0
## GSM1183520           1               0
## GSM1183521           1               0
## GSM1183522           1               0
## GSM1183523           1               0
## GSM1183524           1               0
## GSM1183525           1               0
## GSM1183526           1               0
## GSM1183527           1               0
## GSM1183528           1               0
## GSM1183529           1               0
## GSM1183530           1               0
## GSM1183531           1               0
## GSM1183532           1               0
## GSM1183533           1               0
## GSM1183534           1               0
## GSM1183535           1               0
## GSM1183536           1               0
## GSM1183537           1               0
## GSM1183538           1               0
## GSM1183539           1               0
## GSM1183540           1               0
## GSM1183541           1               0
## GSM1183542           1               0
## GSM1183543           1               0
## GSM1183544           1               0
## GSM1183545           1               0
## GSM1183546           1               0
## GSM1183547           1               0
## GSM1183548           1               0
## GSM1183549           1               0
## GSM1183550           1               0
## GSM1183551           1               0
## GSM1183552           1               0
## GSM1183553           1               0
## GSM1183554           1               0
## GSM1183555           1               0
## GSM1183556           1               0
## GSM1183557           1               0
## GSM1183558           1               0
## GSM1183559           1               0
## GSM1183560           1               0
## GSM1183561           1               0
## attr(,"assign")
## [1] 0 1
## attr(,"contrasts")
## attr(,"contrasts")$new_group
## [1] "contr.treatment"
```

```r
group_subset <- as.character(metadata$geo_accession
														 [which(metadata$group %in% group_names)])
group_subset
```

```
##   [1] "GSM1183439" "GSM1183440" "GSM1183441" "GSM1183442" "GSM1183443"
##   [6] "GSM1183444" "GSM1183453" "GSM1183454" "GSM1183455" "GSM1183456"
##  [11] "GSM1183457" "GSM1183458" "GSM1183459" "GSM1183460" "GSM1183461"
##  [16] "GSM1183462" "GSM1183463" "GSM1183464" "GSM1183465" "GSM1183466"
##  [21] "GSM1183467" "GSM1183468" "GSM1183469" "GSM1183470" "GSM1183471"
##  [26] "GSM1183472" "GSM1183473" "GSM1183474" "GSM1183475" "GSM1183476"
##  [31] "GSM1183477" "GSM1183478" "GSM1183479" "GSM1183480" "GSM1183481"
##  [36] "GSM1183482" "GSM1183483" "GSM1183484" "GSM1183485" "GSM1183486"
##  [41] "GSM1183487" "GSM1183488" "GSM1183489" "GSM1183490" "GSM1183491"
##  [46] "GSM1183492" "GSM1183493" "GSM1183494" "GSM1183495" "GSM1183496"
##  [51] "GSM1183497" "GSM1183498" "GSM1183499" "GSM1183500" "GSM1183501"
##  [56] "GSM1183512" "GSM1183513" "GSM1183514" "GSM1183515" "GSM1183516"
##  [61] "GSM1183517" "GSM1183518" "GSM1183519" "GSM1183520" "GSM1183521"
##  [66] "GSM1183522" "GSM1183523" "GSM1183524" "GSM1183525" "GSM1183526"
##  [71] "GSM1183527" "GSM1183528" "GSM1183529" "GSM1183530" "GSM1183531"
##  [76] "GSM1183532" "GSM1183533" "GSM1183534" "GSM1183535" "GSM1183536"
##  [81] "GSM1183537" "GSM1183538" "GSM1183539" "GSM1183540" "GSM1183541"
##  [86] "GSM1183542" "GSM1183543" "GSM1183544" "GSM1183545" "GSM1183546"
##  [91] "GSM1183547" "GSM1183548" "GSM1183549" "GSM1183550" "GSM1183551"
##  [96] "GSM1183552" "GSM1183553" "GSM1183554" "GSM1183555" "GSM1183556"
## [101] "GSM1183557" "GSM1183558" "GSM1183559" "GSM1183560" "GSM1183561"
```

```r
length(group_subset)
```

```
## [1] 105
```

```r
dat <- M.norm.CGI[, group_subset] %>% droplevels()

head(dat)
```

```
##                          GSM1183439  GSM1183440 GSM1183441 GSM1183442
## chr1:10003165-10003585   -2.6552923 -2.59856415 -2.5445386 -2.5589572
## chr1:1002663-1005318     -0.4691256 -0.09143954 -0.2533638 -0.2153825
## chr1:100315420-100316009 -3.2051837 -3.28066606 -3.1908783 -3.3171275
## chr1:100435297-100436070 -2.6509063 -2.53842308 -2.3740902 -2.6930074
## chr1:100503482-100504404 -2.5912106 -2.61793251 -2.5333289 -2.6985588
## chr1:10057121-10058108   -1.8793069 -1.60397303 -1.9452079 -1.4107345
##                           GSM1183443 GSM1183444 GSM1183453 GSM1183454
## chr1:10003165-10003585   -2.55737653 -2.5826043 -2.4420093 -2.5683021
## chr1:1002663-1005318     -0.09556418 -0.1394251  0.1354862 -0.1364899
## chr1:100315420-100316009 -3.44138495 -3.2638314 -3.1883463 -3.4435985
## chr1:100435297-100436070 -2.58548225 -2.6448828 -1.9642126 -2.5990879
## chr1:100503482-100504404 -2.77076081 -2.7414266 -2.4337830 -2.5278606
## chr1:10057121-10058108   -1.89517507 -2.1822275 -1.7715518 -2.2878826
##                          GSM1183455 GSM1183456 GSM1183457 GSM1183458
## chr1:10003165-10003585   -2.5611068 -2.6112883 -2.9289910 -2.5701139
## chr1:1002663-1005318      0.0855106 -0.1495479 -0.2503045 -0.8035391
## chr1:100315420-100316009 -3.5442221 -3.3321487 -3.4719609 -3.3151074
## chr1:100435297-100436070 -2.9532561 -2.5944388 -2.7733070 -2.8305448
## chr1:100503482-100504404 -2.7577497 -2.6674068 -2.7293921 -2.6465480
## chr1:10057121-10058108   -1.8906351 -2.2961952 -0.7416368 -2.7446878
##                          GSM1183459 GSM1183460 GSM1183461 GSM1183462
## chr1:10003165-10003585   -2.5928901 -2.3889526 -2.6460887 -2.7231261
## chr1:1002663-1005318     -0.0978623 -0.5153299 -0.1302912 -0.2164913
## chr1:100315420-100316009 -3.1202442 -3.1034921 -3.3016168 -3.4521085
## chr1:100435297-100436070 -2.3362214 -2.3185678 -2.5481766 -2.5349049
## chr1:100503482-100504404 -2.6162707 -2.3970941 -2.7532512 -2.7130206
## chr1:10057121-10058108   -2.2802288 -2.7551910 -2.5061829 -0.4842863
##                          GSM1183463 GSM1183464 GSM1183465 GSM1183466
## chr1:10003165-10003585   -2.5491017 -2.4576876 -2.6634236 -2.6269710
## chr1:1002663-1005318      0.1777277  0.2527131  0.1042947 -0.4701124
## chr1:100315420-100316009 -3.2860087 -3.2898758 -3.2739430 -3.3949594
## chr1:100435297-100436070 -2.4025642 -2.3717973 -2.2822308 -2.6972064
## chr1:100503482-100504404 -2.6531850 -2.6213044 -2.6589155 -2.8621837
## chr1:10057121-10058108   -1.7501278 -0.9031143 -1.4175589 -2.5515072
##                          GSM1183467 GSM1183468 GSM1183469 GSM1183470
## chr1:10003165-10003585   -2.5975998 -2.5412295 -2.4850925 -2.4145797
## chr1:1002663-1005318     -0.1106584 -0.3974871 -0.1186928 -0.4646606
## chr1:100315420-100316009 -3.3165319 -3.2531491 -3.0885286 -3.3201661
## chr1:100435297-100436070 -2.7201684 -2.6577729 -2.6383212 -2.6271861
## chr1:100503482-100504404 -2.7140042 -2.6688105 -2.6891018 -2.5954421
## chr1:10057121-10058108   -1.9689749 -2.1921074 -2.1734550 -2.1911826
##                          GSM1183471 GSM1183472  GSM1183473 GSM1183474
## chr1:10003165-10003585   -2.5213979  -2.466313 -2.55134704 -2.4765215
## chr1:1002663-1005318     -0.2727839  -0.204244  0.04854337 -0.3592211
## chr1:100315420-100316009 -3.2953992  -3.218619 -3.28942467 -3.4000418
## chr1:100435297-100436070 -2.5079133  -2.562802 -2.69858064 -2.6323302
## chr1:100503482-100504404 -2.6814858  -2.463127 -2.67413839 -2.8827299
## chr1:10057121-10058108   -1.9749580  -2.118518 -1.98687058 -1.6137291
##                          GSM1183475 GSM1183476 GSM1183477 GSM1183478
## chr1:10003165-10003585   -2.5553456 -2.5007390 -2.5346772 -2.5382355
## chr1:1002663-1005318     -0.2639951 -0.3881833 -0.1877652 -0.2008505
## chr1:100315420-100316009 -3.3787453 -3.3049143 -3.2620533 -3.2547827
## chr1:100435297-100436070 -2.6092785 -2.6791712 -2.6729198 -2.6679753
## chr1:100503482-100504404 -2.7651728 -2.7097997 -2.7011483 -2.6685389
## chr1:10057121-10058108   -1.9800005 -2.2907397 -1.6842134 -2.2742424
##                           GSM1183479 GSM1183480 GSM1183481 GSM1183482
## chr1:10003165-10003585   -2.78934539 -2.4393726  -2.470685 -2.4599626
## chr1:1002663-1005318      0.03098998 -0.3446402  -0.356047 -0.2735848
## chr1:100315420-100316009 -3.22150296 -3.2752470  -3.283137 -3.2123623
## chr1:100435297-100436070 -2.49583434 -2.6676062  -2.679606 -2.6550079
## chr1:100503482-100504404 -2.66726367 -2.8328728  -2.624475 -2.7429252
## chr1:10057121-10058108   -1.90776652 -2.5284930  -2.390040 -2.4086346
##                          GSM1183483  GSM1183484 GSM1183485 GSM1183486
## chr1:10003165-10003585   -2.6406160 -2.70045313 -2.7033185 -2.6432762
## chr1:1002663-1005318      0.1419676  0.02287766 -0.2400202 -0.0466823
## chr1:100315420-100316009 -3.2889347 -3.48242760 -3.2918360 -3.3131523
## chr1:100435297-100436070 -2.4959864 -2.78518605 -2.5886347 -2.5103397
## chr1:100503482-100504404 -2.8480882 -2.70227145 -2.8255920 -2.5938201
## chr1:10057121-10058108   -2.1335111 -2.58234107 -1.7365505 -2.1008323
##                          GSM1183487 GSM1183488 GSM1183489 GSM1183490
## chr1:10003165-10003585   -2.1723282 -2.4762976 -2.7209445 -2.6450045
## chr1:1002663-1005318      0.3671142 -0.2484297  0.1206241  0.1053612
## chr1:100315420-100316009 -2.8700148 -3.1976002 -3.0185030 -2.9115272
## chr1:100435297-100436070 -2.0898900 -2.6466377 -2.3003844 -2.3822229
## chr1:100503482-100504404 -2.3997197 -2.7176038 -2.5165885 -2.6060197
## chr1:10057121-10058108   -1.7340586 -2.0591488 -2.0783172 -1.6675826
##                          GSM1183491 GSM1183492 GSM1183493 GSM1183494
## chr1:10003165-10003585   -2.6654612 -2.3219709 -2.4483201 -2.5511022
## chr1:1002663-1005318      0.3462601  0.4469207  0.1254926 -0.5048053
## chr1:100315420-100316009 -3.1088263 -2.9417798 -3.4914174 -3.3202710
## chr1:100435297-100436070 -2.3348525 -2.0809495 -2.4237925 -2.4554246
## chr1:100503482-100504404 -2.6348955 -2.4477740 -2.7663400 -2.9570593
## chr1:10057121-10058108   -2.0751118 -1.8962422 -1.7759178 -2.1877155
##                           GSM1183495  GSM1183496  GSM1183497  GSM1183498
## chr1:10003165-10003585   -2.63486408 -2.48162177 -2.47640016 -2.58026479
## chr1:1002663-1005318     -0.06303079 -0.02946225 -0.09298967 -0.08300383
## chr1:100315420-100316009 -3.30801504 -3.18349564 -3.32868542 -3.30487740
## chr1:100435297-100436070 -2.55596834 -2.52263929 -2.71459787 -2.58571296
## chr1:100503482-100504404 -2.68080449 -2.76371740 -2.82548106 -2.97470935
## chr1:10057121-10058108   -1.83718920 -2.17762440 -2.30781157 -2.10909408
##                           GSM1183499 GSM1183500 GSM1183501 GSM1183512
## chr1:10003165-10003585   -2.63209567 -2.4744933 -2.4949798 -2.4611793
## chr1:1002663-1005318     -0.03106036 -0.3583119 -0.3324479 -0.6593965
## chr1:100315420-100316009 -3.34801905 -3.3203624 -3.2989031 -3.4518730
## chr1:100435297-100436070 -2.73638456 -2.6032170 -2.6614142 -3.0160474
## chr1:100503482-100504404 -2.73326044 -2.7836071 -2.6894563 -2.8171447
## chr1:10057121-10058108   -2.27761366 -2.0391860 -2.5430220 -2.8274641
##                          GSM1183513   GSM1183514 GSM1183515 GSM1183516
## chr1:10003165-10003585   -2.5232826 -2.794565724 -2.5574941 -2.4817320
## chr1:1002663-1005318     -0.3996432 -0.893026075  0.1908337 -0.3539109
## chr1:100315420-100316009 -3.3672605 -3.590974285 -3.1601333 -3.3948670
## chr1:100435297-100436070 -2.5688085 -2.871634800 -2.6326338 -2.8575446
## chr1:100503482-100504404 -2.6757521 -2.839093719 -2.7675520 -2.7245740
## chr1:10057121-10058108   -2.5582427 -0.004961779 -2.7167976 -2.4120587
##                           GSM1183517 GSM1183518 GSM1183519 GSM1183520
## chr1:10003165-10003585   -2.70980738 -2.4192976 -2.8827217  -2.516365
## chr1:1002663-1005318     -1.25742650 -0.2876498 -0.3800922   0.487411
## chr1:100315420-100316009 -3.39826153 -3.1621329 -3.4278863  -3.180156
## chr1:100435297-100436070 -2.81982492 -2.5290203 -2.7879821  -2.160308
## chr1:100503482-100504404 -2.86439386 -2.5466905 -2.5341330  -2.466457
## chr1:10057121-10058108    0.02238012 -2.2057753 -2.7943131  -1.627597
##                          GSM1183521 GSM1183522 GSM1183523 GSM1183524
## chr1:10003165-10003585   -2.4537406 -2.6946777 -2.4622112 -2.5451917
## chr1:1002663-1005318     -0.1899291 -0.6922016 -0.3450193 -0.4116018
## chr1:100315420-100316009 -3.3113328 -3.2982204 -3.5347077 -3.3356859
## chr1:100435297-100436070 -2.7512474 -2.8967630 -2.7015844 -2.6075023
## chr1:100503482-100504404 -2.7391940 -2.9843558 -2.7011248 -2.5565389
## chr1:10057121-10058108   -2.6084962 -2.7768410 -2.3584792 -2.3597911
##                          GSM1183525 GSM1183526 GSM1183527  GSM1183528
## chr1:10003165-10003585   -2.6681450 -2.8270665  -2.715084 -2.51442884
## chr1:1002663-1005318      0.1524643 -0.9742143  -1.052124 -0.07902266
## chr1:100315420-100316009 -3.2475622 -3.6032944  -3.577829 -3.25446329
## chr1:100435297-100436070 -2.4573471 -2.9766122  -3.096443 -2.51894210
## chr1:100503482-100504404 -2.7428883 -2.8149033  -2.786104 -2.52975089
## chr1:10057121-10058108   -1.9721684 -3.0843057  -2.856401 -2.35051733
##                          GSM1183529  GSM1183530 GSM1183531 GSM1183532
## chr1:10003165-10003585   -2.5722132 -2.51044935 -2.5230189 -2.4772421
## chr1:1002663-1005318     -0.1090344 -0.08058042 -0.7695092 -0.9591101
## chr1:100315420-100316009 -3.3411582 -3.40226436 -3.3759884 -3.5681969
## chr1:100435297-100436070 -2.5145817 -2.78800177 -2.7818569 -2.8156503
## chr1:100503482-100504404 -2.6832643 -2.61647446 -2.6662381 -2.7690945
## chr1:10057121-10058108   -2.0999465 -2.45045802 -2.6505661 -2.6469958
##                          GSM1183533 GSM1183534 GSM1183535 GSM1183536
## chr1:10003165-10003585   -2.5054475 -2.5991168  -2.363892  -2.666929
## chr1:1002663-1005318     -0.5369419 -0.5766602  -0.154614  -1.045520
## chr1:100315420-100316009 -3.2956107 -3.3664893  -3.383797  -3.531605
## chr1:100435297-100436070 -2.5494621 -2.6290269  -2.777329  -2.977179
## chr1:100503482-100504404 -2.5586073 -2.7199332  -2.684621  -2.946696
## chr1:10057121-10058108   -2.2942003 -2.6646535  -2.439123  -1.864672
##                          GSM1183537 GSM1183538 GSM1183539 GSM1183540
## chr1:10003165-10003585    -2.616571 -2.5416443 -2.8752842 -2.4306625
## chr1:1002663-1005318      -1.254954 -0.8628501 -0.5308050  0.2092777
## chr1:100315420-100316009  -3.549230 -3.4468167 -3.5223805 -3.2474810
## chr1:100435297-100436070  -2.886160 -2.7070430 -2.7828174 -2.6042976
## chr1:100503482-100504404  -2.937330 -2.7255946 -2.9606268 -2.6586909
## chr1:10057121-10058108    -2.005083 -2.9946131 -0.8160312 -1.7308273
##                          GSM1183541 GSM1183542 GSM1183543  GSM1183544
## chr1:10003165-10003585   -2.5951367  -2.676305 -2.4328712 -2.68895993
## chr1:1002663-1005318     -0.1439707  -1.074767 -0.5943623 -0.04813778
## chr1:100315420-100316009 -3.1633167  -3.499562 -3.3082008 -3.19362168
## chr1:100435297-100436070 -2.3120103  -2.978451 -2.7679585 -2.45400458
## chr1:100503482-100504404 -2.6340278  -3.017156 -2.5032138 -2.69788563
## chr1:10057121-10058108   -2.5610825  -2.911221 -2.8442728 -1.89665624
##                          GSM1183545 GSM1183546 GSM1183547  GSM1183548
## chr1:10003165-10003585   -2.4035817 -2.7173873 -2.4708077 -2.67047241
## chr1:1002663-1005318      0.3884715 -0.3234209 -0.1919004 -0.05228926
## chr1:100315420-100316009 -3.1150482 -3.4909309 -3.4013430 -3.30489431
## chr1:100435297-100436070 -2.1515453 -2.6983911 -2.6156074 -2.37281582
## chr1:100503482-100504404 -2.6480267 -2.9672095 -2.7828367 -2.67066895
## chr1:10057121-10058108   -1.8706002 -2.0210757 -2.2382613 -2.38875900
##                          GSM1183549 GSM1183550 GSM1183551 GSM1183552
## chr1:10003165-10003585    -2.873039  -2.902766 -2.6086813 -2.2954377
## chr1:1002663-1005318      -1.225704  -1.020126 -0.4032427  0.3948961
## chr1:100315420-100316009  -3.534048  -3.648111 -3.4765112 -3.0633456
## chr1:100435297-100436070  -3.085966  -2.986475 -2.6783351 -2.0686436
## chr1:100503482-100504404  -3.019369  -2.945886 -2.9638341 -2.4317759
## chr1:10057121-10058108    -2.206652  -2.058766 -2.3911001 -2.0523751
##                          GSM1183553  GSM1183554 GSM1183555  GSM1183556
## chr1:10003165-10003585   -2.4534002 -2.59945570 -2.7170612 -2.47360455
## chr1:1002663-1005318      0.1173246  0.01771181  0.0363121  0.02016923
## chr1:100315420-100316009 -3.2935863 -3.26522873 -3.5089492 -3.36980796
## chr1:100435297-100436070 -2.4689794 -2.49531811 -2.5036881 -2.75306404
## chr1:100503482-100504404 -2.6365286 -2.67921463 -2.6449797 -2.76934714
## chr1:10057121-10058108   -1.7506630 -2.19764846 -2.1389980 -2.56401695
##                          GSM1183557   GSM1183558  GSM1183559 GSM1183560
## chr1:10003165-10003585   -2.7437807 -2.793726717 -2.57914633 -2.8330552
## chr1:1002663-1005318     -0.5060306 -1.417894319 -0.04596533 -1.1547271
## chr1:100315420-100316009 -3.3420403 -3.535314747 -3.32159900 -3.7492971
## chr1:100435297-100436070 -2.7442860 -3.275508203 -2.52344354 -2.9957279
## chr1:100503482-100504404 -2.6517998 -2.940411823 -2.64300275 -3.0614550
## chr1:10057121-10058108   -2.8584225 -0.001879325 -1.96268277 -0.5575545
##                          GSM1183561
## chr1:10003165-10003585   -2.7309010
## chr1:1002663-1005318     -0.8737399
## chr1:100315420-100316009 -3.5794866
## chr1:100435297-100436070 -2.7698383
## chr1:100503482-100504404 -2.7066204
## chr1:10057121-10058108   -1.7797307
```

```r
ncol(dat)
```

```
## [1] 105
```

```r
file_name <- paste0("../../data/limma/topTable_", goal, ".Rdata")
limmaTopTables(dat, desMat.group, file_name)

load(file_name)

head(myTopTable)
```

```
##                               logFC    AveExpr         t      P.Value
## chr8:145103285-145108027 -1.8737262 -0.9755083 -17.59241 3.740858e-33
## chr17:27939298-27940770  -1.2733401  2.3219560 -15.08230 4.333147e-28
## chr1:1476093-1476669     -1.4322686  1.1098149 -14.96436 7.638591e-28
## chr8:67344497-67344989   -2.2061031 -0.2268103 -14.61666 4.102295e-27
## chr2:210010093-210010367  0.8659652  1.1148044  14.41489 1.095040e-26
## chr21:10884732-10885087   0.6808281  1.1380020  14.11426 4.769735e-26
##                             adj.P.Val        B
## chr8:145103285-145108027 9.876988e-29 64.59529
## chr17:27939298-27940770  5.720404e-24 53.23359
## chr1:1476093-1476669     6.722724e-24 52.67961
## chr8:67344497-67344989   2.707822e-23 51.03631
## chr2:210010093-210010367 5.782467e-23 50.07596
## chr21:10884732-10885087  2.098922e-22 48.63602
```




```r
## plot density
ggplot(myTopTable, aes(adj.P.Val)) + 
	stat_density(geom = "line", position = "identity") +
	ggtitle("FDR density")
```

![](04.1limma-normal_vs_cancer_files/figure-html/density_plot-1.png) 

```r
ggplot(myTopTable, aes(adj.P.Val)) + 
	geom_histogram(position="identity") +
	ggtitle("FDR density")
```

```
## stat_bin: binwidth defaulted to range/30. Use 'binwidth = x' to adjust this.
```

![](04.1limma-normal_vs_cancer_files/figure-html/density_plot-2.png) 


Setting cutoffs


```r
cutoff <- 1e-3
length(which(myTopTable$adj.P.Val < cutoff))
```

```
## [1] 10897
```


plotHeatmap <- function(x, title = "", legend = "group", 
												size = 2, names = F, 
												row_dendrogram = F, col_dendrogram = F)


```r
top <- length(which(myTopTable$adj.P.Val < cutoff))
top_genes <-as.character(rownames(myTopTable)[1:top]) 
head(top_genes)
```

```
## [1] "chr8:145103285-145108027" "chr17:27939298-27940770" 
## [3] "chr1:1476093-1476669"     "chr8:67344497-67344989"  
## [5] "chr2:210010093-210010367" "chr21:10884732-10885087"
```

```r
top_matrix <- subsetData(M.norm.CGI, top_genes, design = metadata)

#subset to the groups
top_matrix <- top_matrix[, group_subset]
head(top_matrix)	
```

```
##                          GSM1183439 GSM1183440  GSM1183441  GSM1183442
## chr1:100315420-100316009 -3.2051837 -3.2806661 -3.19087826 -3.31712752
## chr1:100598130-100598754 -1.9714498 -1.9132124 -1.89852945 -2.26281243
## chr1:10092532-10093404   -2.3570311 -2.3156555 -2.36184751 -2.29364114
## chr1:101004471-101005885  0.1934226  0.2205404  0.01254285 -0.09443836
## chr1:101360588-101360832 -2.1477230 -2.1414693 -2.06203114 -2.00875535
## chr1:101361549-101361808 -3.0395576 -3.1130773 -2.95806386 -3.20992418
##                          GSM1183443 GSM1183444 GSM1183453 GSM1183454
## chr1:100315420-100316009  -3.441385 -3.2638314 -3.1883463 -3.4435985
## chr1:100598130-100598754  -2.144724 -1.9648685 -1.9694692 -2.0125626
## chr1:10092532-10093404    -2.382056 -2.3604274 -2.0706082 -2.3948871
## chr1:101004471-101005885   0.405023 -0.1085183 -0.2047227  0.5951251
## chr1:101360588-101360832  -2.352259 -2.0743261 -1.9243614 -1.9722165
## chr1:101361549-101361808  -3.217272 -3.1137367 -3.0160361 -3.2451245
##                          GSM1183455 GSM1183456 GSM1183457 GSM1183458
## chr1:100315420-100316009 -3.5442221 -3.3321487  -3.471961  -3.315107
## chr1:100598130-100598754 -2.1557730 -1.9301729  -2.193059  -2.180452
## chr1:10092532-10093404   -2.3339609 -2.1877619  -2.544809  -2.564582
## chr1:101004471-101005885  0.4061053 -0.5418404   1.335761   1.453228
## chr1:101360588-101360832 -2.2483696 -1.8220087  -2.311879  -2.158227
## chr1:101361549-101361808 -3.4187128 -3.1790811  -3.595035  -3.332694
##                          GSM1183459 GSM1183460 GSM1183461 GSM1183462
## chr1:100315420-100316009 -3.1202442 -3.1034921 -3.3016168 -3.4521085
## chr1:100598130-100598754 -1.9318416 -2.1411769 -2.0270965 -2.2522359
## chr1:10092532-10093404   -2.0576521 -2.3282745 -2.2846836 -2.5419958
## chr1:101004471-101005885  0.6732099  0.4295538  0.8335591  0.9155575
## chr1:101360588-101360832 -1.9547967 -1.7719807 -2.2714404 -2.3001661
## chr1:101361549-101361808 -3.0522471 -3.0803286 -3.2707603 -3.5317455
##                          GSM1183463 GSM1183464 GSM1183465 GSM1183466
## chr1:100315420-100316009  -3.286009 -3.2898758 -3.2739430  -3.394959
## chr1:100598130-100598754  -2.086675 -2.0163064 -2.1458382  -2.097008
## chr1:10092532-10093404    -2.282139 -2.2592483 -2.3353729  -2.458452
## chr1:101004471-101005885   0.860481  0.5877002  0.9408646   1.191676
## chr1:101360588-101360832  -2.356607 -2.1136145 -2.3702963  -2.243765
## chr1:101361549-101361808  -3.080319 -3.0906526 -3.1192320  -3.257263
##                          GSM1183467  GSM1183468  GSM1183469  GSM1183470
## chr1:100315420-100316009 -3.3165319 -3.25314914 -3.08852861 -3.32016614
## chr1:100598130-100598754 -2.1771845 -2.00235275 -2.05888751 -2.12123516
## chr1:10092532-10093404   -2.1750333 -2.15138320 -2.15002005 -2.19091443
## chr1:101004471-101005885 -0.1415446  0.04248716 -0.07260053  0.07848687
## chr1:101360588-101360832 -1.8301476 -1.91318574 -1.89840225 -1.82018338
## chr1:101361549-101361808 -3.2000064 -3.05011621 -3.07343170 -3.08721614
##                           GSM1183471 GSM1183472  GSM1183473 GSM1183474
## chr1:100315420-100316009 -3.29539919 -3.2186189 -3.28942467 -3.4000418
## chr1:100598130-100598754 -2.04002347 -2.2102448 -2.02486430 -2.1248498
## chr1:10092532-10093404   -2.11934395 -2.0175880 -2.32179665 -2.0009216
## chr1:101004471-101005885 -0.09915888 -0.1140693  0.08770596 -0.0509076
## chr1:101360588-101360832 -1.79112151 -1.6936440 -1.81414568 -1.8275677
## chr1:101361549-101361808 -3.19000475 -3.1310626 -3.08555230 -2.9768527
##                           GSM1183475 GSM1183476 GSM1183477 GSM1183478
## chr1:100315420-100316009 -3.37874527 -3.3049143 -3.2620533  -3.254783
## chr1:100598130-100598754 -2.02951605 -1.9302812 -2.1102395  -2.136438
## chr1:10092532-10093404   -2.04253923 -2.0632025 -2.2108366  -2.186156
## chr1:101004471-101005885 -0.05674383  0.1165213 -0.3018392  -0.088378
## chr1:101360588-101360832 -1.77489060 -1.6352125 -1.8144009  -1.698825
## chr1:101361549-101361808 -3.13280036 -3.2656069 -3.2383637  -3.047918
##                          GSM1183479 GSM1183480 GSM1183481 GSM1183482
## chr1:100315420-100316009 -3.2215030 -3.2752470 -3.2831370 -3.2123623
## chr1:100598130-100598754 -2.1932504 -2.0953272 -2.0224740 -2.0572247
## chr1:10092532-10093404   -1.9582141 -2.2258785 -2.0260373 -2.1569839
## chr1:101004471-101005885 -0.3206666  0.2335531 -0.1380234 -0.1201977
## chr1:101360588-101360832 -1.5985126 -1.6841937 -1.7680406 -1.6938970
## chr1:101361549-101361808 -3.0947409 -3.1857105 -3.0295013 -3.0303451
##                          GSM1183483 GSM1183484  GSM1183485   GSM1183486
## chr1:100315420-100316009 -3.2889347 -3.4824276 -3.29183604 -3.313152333
## chr1:100598130-100598754 -2.1851601 -2.2278975 -2.18758765 -2.108116207
## chr1:10092532-10093404   -2.0729508 -2.4387857 -2.27174634 -1.940353345
## chr1:101004471-101005885 -0.1838817  0.1331555 -0.04136354 -0.009145921
## chr1:101360588-101360832 -1.6425746 -1.7625065 -1.87002683 -1.794097811
## chr1:101361549-101361808 -3.0150873 -3.3092032 -3.39570105 -3.063755125
##                          GSM1183487  GSM1183488   GSM1183489 GSM1183490
## chr1:100315420-100316009 -2.8700148 -3.19760022 -3.018503008 -2.9115272
## chr1:100598130-100598754 -1.9544186 -2.06866159 -2.119966529 -2.0245257
## chr1:10092532-10093404   -1.7824093 -2.07249212 -1.994557629 -1.9673313
## chr1:101004471-101005885 -0.1746608 -0.05326452 -0.005314451 -0.2548346
## chr1:101360588-101360832 -1.7202375 -1.73829700 -1.711964416 -1.7839576
## chr1:101361549-101361808 -2.8826231 -2.99808073 -3.057134265 -2.9916475
##                          GSM1183491 GSM1183492 GSM1183493 GSM1183494
## chr1:100315420-100316009 -3.1088263 -2.9417798 -3.4914174 -3.3202710
## chr1:100598130-100598754 -2.0399057 -2.0145643 -2.0998605 -2.0985951
## chr1:10092532-10093404   -1.9759063 -1.8206156 -2.2301692 -2.1898843
## chr1:101004471-101005885  0.2402319 -0.4312667 -0.1053052  0.1032393
## chr1:101360588-101360832 -1.7622897 -1.7527875 -1.9023950 -1.9670139
## chr1:101361549-101361808 -3.0171776 -2.8443610 -3.2166956 -3.0522011
##                          GSM1183495 GSM1183496 GSM1183497    GSM1183498
## chr1:100315420-100316009 -3.3080150 -3.1834956 -3.3286854 -3.3048774030
## chr1:100598130-100598754 -2.2020767 -2.3833162 -2.2109364 -2.2282145527
## chr1:10092532-10093404   -2.1720858 -2.1729652 -2.2626461 -2.2291013659
## chr1:101004471-101005885 -0.1701401 -0.1993957  0.3062086 -0.0002271574
## chr1:101360588-101360832 -1.9774521 -1.7579062 -1.9551582 -1.8549578620
## chr1:101361549-101361808 -3.2514199 -3.0998843 -3.2576912 -3.2247412146
##                          GSM1183499 GSM1183500 GSM1183501 GSM1183512
## chr1:100315420-100316009 -3.3480190 -3.3203624 -3.2989031  -3.451873
## chr1:100598130-100598754 -2.1742859 -2.1652998 -2.0029887  -2.055622
## chr1:10092532-10093404   -2.0936346 -2.1797602 -2.1792289  -2.329846
## chr1:101004471-101005885 -0.0251888 -0.1504986  0.5102253   1.057051
## chr1:101360588-101360832 -2.0373177 -1.8150546 -1.8495705  -1.838025
## chr1:101361549-101361808 -3.3124131 -3.3490370 -3.1456577  -3.305112
##                          GSM1183513 GSM1183514 GSM1183515 GSM1183516
## chr1:100315420-100316009 -3.3672605  -3.590974  -3.160133 -3.3948670
## chr1:100598130-100598754 -2.0452555  -2.560755  -1.917462 -2.2323675
## chr1:10092532-10093404   -2.4338824  -2.658781  -2.131715 -2.2909937
## chr1:101004471-101005885 -0.3908778   1.036337  -0.533926  0.4174549
## chr1:101360588-101360832 -1.8620404  -2.210460  -1.353466 -1.9431901
## chr1:101361549-101361808 -3.2111086  -3.374769  -2.733344 -3.2468335
##                          GSM1183517 GSM1183518 GSM1183519  GSM1183520
## chr1:100315420-100316009  -3.398262  -3.162133 -3.4278863 -3.18015614
## chr1:100598130-100598754  -2.236822  -2.089453 -2.3331449 -2.15289465
## chr1:10092532-10093404    -2.604705  -2.171736 -2.2735736 -1.99454052
## chr1:101004471-101005885   1.506408   1.519576 -0.3171923 -0.07189812
## chr1:101360588-101360832  -2.247164  -1.751151 -1.6027161 -1.58260487
## chr1:101361549-101361808  -3.275702  -3.060142 -3.3606066 -3.14942909
##                          GSM1183521 GSM1183522 GSM1183523 GSM1183524
## chr1:100315420-100316009  -3.311333  -3.298220 -3.5347077 -3.3356859
## chr1:100598130-100598754  -2.069582  -2.330345 -2.1892714 -2.0667892
## chr1:10092532-10093404    -2.276431  -2.518416 -2.3637118 -2.3691434
## chr1:101004471-101005885   1.456635   1.121576  0.9740272  0.5771825
## chr1:101360588-101360832  -1.838563  -2.130211 -1.8908968 -1.8478820
## chr1:101361549-101361808  -3.347072  -3.191341 -3.2297693 -3.1614924
##                          GSM1183525 GSM1183526   GSM1183527 GSM1183528
## chr1:100315420-100316009  -3.247562  -3.603294 -3.577829198 -3.2544633
## chr1:100598130-100598754  -2.363139  -2.351801 -2.798818910 -2.2428916
## chr1:10092532-10093404    -2.263229  -2.660274 -2.505282808 -2.3746902
## chr1:101004471-101005885   1.165427   2.108608  0.007391619  0.4558055
## chr1:101360588-101360832  -2.238433  -1.989710 -1.985949624 -1.7739098
## chr1:101361549-101361808  -3.308305  -3.361416 -3.371436654 -3.0135975
##                          GSM1183529 GSM1183530 GSM1183531 GSM1183532
## chr1:100315420-100316009 -3.3411582  -3.402264 -3.3759884  -3.568197
## chr1:100598130-100598754 -2.1647221  -2.098695 -2.1858760  -2.212123
## chr1:10092532-10093404   -2.2140867  -2.257214 -2.2045838  -2.181740
## chr1:101004471-101005885  0.1525974   1.216056  0.4304932   1.644684
## chr1:101360588-101360832 -1.9556554  -1.796815 -1.8589561  -1.865881
## chr1:101361549-101361808 -3.1779007  -3.164554 -3.1914943  -3.170582
##                          GSM1183533 GSM1183534 GSM1183535 GSM1183536
## chr1:100315420-100316009 -3.2956107  -3.366489 -3.3837974  -3.531605
## chr1:100598130-100598754 -2.0850811  -2.217961 -2.1668791  -2.292133
## chr1:10092532-10093404   -2.1452413  -2.407504 -2.1453637  -2.295013
## chr1:101004471-101005885  0.1884139   1.662152  0.6220541   1.223967
## chr1:101360588-101360832 -1.8620097  -2.057426 -1.6935141  -2.000847
## chr1:101361549-101361808 -3.2421848  -3.154609 -3.3164105  -3.445375
##                          GSM1183537 GSM1183538 GSM1183539 GSM1183540
## chr1:100315420-100316009  -3.549230 -3.4468167 -3.5223805 -3.2474810
## chr1:100598130-100598754  -2.384871 -1.9415845 -2.5189891 -2.2413571
## chr1:10092532-10093404    -2.552865 -1.9695258 -2.6646619 -2.3171107
## chr1:101004471-101005885   1.854454  0.9774079  0.9416084  0.6236751
## chr1:101360588-101360832  -2.097463 -1.7641440 -2.2791260 -2.0200722
## chr1:101361549-101361808  -3.363879 -3.0129034 -3.2955878 -3.2183163
##                          GSM1183541 GSM1183542 GSM1183543 GSM1183544
## chr1:100315420-100316009  -3.163317  -3.499562 -3.3082008 -3.1936217
## chr1:100598130-100598754  -2.277620  -2.271280 -2.1882803 -2.2061789
## chr1:10092532-10093404    -2.120550  -2.459804 -2.3363591 -2.2399711
## chr1:101004471-101005885   1.079230   1.899135  0.7642321  0.8224525
## chr1:101360588-101360832  -2.258576  -2.012621 -1.8557026 -1.8175270
## chr1:101361549-101361808  -3.088888  -3.532961 -3.3685020 -3.3569253
##                          GSM1183545 GSM1183546 GSM1183547 GSM1183548
## chr1:100315420-100316009 -3.1150482  -3.490931 -3.4013430 -3.3048943
## chr1:100598130-100598754 -2.2447672  -2.476595 -2.2072148 -2.2934091
## chr1:10092532-10093404   -2.1087010  -2.324604 -2.2046595 -1.9800180
## chr1:101004471-101005885  0.2425311   1.072878  0.4461597  0.3160271
## chr1:101360588-101360832 -1.9376475  -2.167865 -1.9909927 -2.1478928
## chr1:101361549-101361808 -3.3015558  -3.263851 -3.1940937 -3.1655971
##                          GSM1183549 GSM1183550 GSM1183551  GSM1183552
## chr1:100315420-100316009 -3.5340478  -3.648111  -3.476511 -3.06334555
## chr1:100598130-100598754 -2.3865787  -2.546082  -2.588058 -2.04340738
## chr1:10092532-10093404   -2.3781200  -2.729302  -2.395448 -1.86445873
## chr1:101004471-101005885  0.9101036   1.310247   1.186437  0.06162337
## chr1:101360588-101360832 -2.1452256  -2.390731  -1.936123 -1.78880129
## chr1:101361549-101361808 -3.4623987  -3.370031  -3.513757 -3.02967808
##                          GSM1183553 GSM1183554 GSM1183555  GSM1183556
## chr1:100315420-100316009 -3.2935863 -3.2652287 -3.5089492 -3.36980796
## chr1:100598130-100598754 -2.2007970 -2.2852938 -2.2337993 -2.30503524
## chr1:10092532-10093404   -2.2374982 -2.1971124 -2.1798524 -2.24134116
## chr1:101004471-101005885  0.3314186  0.9191377  0.9012555 -0.09443593
## chr1:101360588-101360832 -1.8846946 -1.9479106 -2.0223066 -1.89629834
## chr1:101361549-101361808 -3.1922943 -3.1220969 -4.2251507 -3.22822449
##                          GSM1183557 GSM1183558 GSM1183559 GSM1183560
## chr1:100315420-100316009  -3.342040  -3.535315  -3.321599  -3.749297
## chr1:100598130-100598754  -2.305568  -2.367959  -2.256017  -2.415024
## chr1:10092532-10093404    -2.286100  -2.906736  -2.115365  -2.702290
## chr1:101004471-101005885   1.084267   1.014650   1.247516   1.176954
## chr1:101360588-101360832  -2.225779  -2.265374  -2.019176  -2.045986
## chr1:101361549-101361808  -3.100253  -3.464713  -3.300918  -3.361644
##                          GSM1183561
## chr1:100315420-100316009  -3.579487
## chr1:100598130-100598754  -2.388894
## chr1:10092532-10093404    -2.444873
## chr1:101004471-101005885   1.412469
## chr1:101360588-101360832  -1.962166
## chr1:101361549-101361808  -3.363343
```

```r
ncol(top_matrix)
```

```
## [1] 105
```

```r
plotHeatmap(top_matrix, title = paste0("Heatmap of top ", top, "\n", goal),
						col_dendrogram = T, row_dendrogram = T)
```

![](04.1limma-normal_vs_cancer_files/figure-html/heatmap-1.png) 
