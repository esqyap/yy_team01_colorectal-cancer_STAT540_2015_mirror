# LIMMA_analysis: normal-C vs normal-H
Beryl Zhuang  
Sunday, April 05, 2015  
#### Differential methylation analysis comparing normal-c and normal-H


*LIMMA codes are writen by Ka Ming. The codes are modified for this analysis.


DMA for normal-C and normal-H samples.


```r
library(dplyr)
```

```
## 
## Attaching package: 'dplyr'
## 
## The following object is masked from 'package:stats':
## 
##     filter
## 
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

```r
library(limma)
library(ggplot2)
```


```r
source("../../rscripts/helper_functions.R")
```



```r
# codes from Ka Ming

# loading the norm. CGI.
M.norm.CGI.path <- "../../data/GSE48684_raw_filtered.m.norm.cgi.Rdata"
load(M.norm.CGI.path)
M.norm.CGI <- na.omit(M.norm.CGI)

# load the metadata
metadata.path <- "../../data/metadata.Rdata"
load(metadata.path)

# sanity check
head(M.norm.CGI)
```

```
##                          GSM1183439  GSM1183440 GSM1183441 GSM1183442
## chr1:10003165-10003585   -2.6552923 -2.59856415 -2.5445386 -2.5589572
## chr1:1002663-1005318     -0.4691256 -0.09143954 -0.2533638 -0.2153825
## chr1:100315420-100316009 -3.2051837 -3.28066606 -3.1908783 -3.3171275
## chr1:100435297-100436070 -2.6509063 -2.53842308 -2.3740902 -2.6930074
## chr1:100503482-100504404 -2.5912106 -2.61793251 -2.5333289 -2.6985588
## chr1:10057121-10058108   -1.8793069 -1.60397303 -1.9452079 -1.4107345
##                           GSM1183443 GSM1183444 GSM1183445 GSM1183446
## chr1:10003165-10003585   -2.55737653 -2.5826043 -2.4911736  -2.554945
## chr1:1002663-1005318     -0.09556418 -0.1394251 -0.9472826  -0.156273
## chr1:100315420-100316009 -3.44138495 -3.2638314 -3.5903340  -3.175695
## chr1:100435297-100436070 -2.58548225 -2.6448828 -2.8978879  -2.530715
## chr1:100503482-100504404 -2.77076081 -2.7414266 -2.8660505  -2.676452
## chr1:10057121-10058108   -1.89517507 -2.1822275 -2.7476044  -1.366660
##                          GSM1183447 GSM1183448 GSM1183449 GSM1183450
## chr1:10003165-10003585   -2.8167373 -2.6015900 -2.7326851  -2.687569
## chr1:1002663-1005318     -0.9355684 -0.5594806 -0.9262892  -1.276605
## chr1:100315420-100316009 -3.7200904 -3.4311690 -3.5356330  -3.462461
## chr1:100435297-100436070 -2.9591127 -2.7513380 -2.9045330  -2.883730
## chr1:100503482-100504404 -2.7442432 -2.7249048 -2.7322991  -2.698558
## chr1:10057121-10058108   -2.7962893 -1.6385844 -2.9030710  -3.324011
##                          GSM1183451 GSM1183452 GSM1183453 GSM1183454
## chr1:10003165-10003585    -2.739601 -2.3145316 -2.4420093 -2.5683021
## chr1:1002663-1005318      -0.547058  0.2199845  0.1354862 -0.1364899
## chr1:100315420-100316009  -3.476851 -3.2057071 -3.1883463 -3.4435985
## chr1:100435297-100436070  -3.013518 -1.7599024 -1.9642126 -2.5990879
## chr1:100503482-100504404  -2.841048 -2.3777453 -2.4337830 -2.5278606
## chr1:10057121-10058108    -2.548544 -1.3898947 -1.7715518 -2.2878826
##                          GSM1183455 GSM1183456 GSM1183457 GSM1183458
## chr1:10003165-10003585   -2.5611068 -2.6112883 -2.9289910 -2.5701139
## chr1:1002663-1005318      0.0855106 -0.1495479 -0.2503045 -0.8035391
## chr1:100315420-100316009 -3.5442221 -3.3321487 -3.4719609 -3.3151074
## chr1:100435297-100436070 -2.9532561 -2.5944388 -2.7733070 -2.8305448
## chr1:100503482-100504404 -2.7577497 -2.6674068 -2.7293921 -2.6465480
## chr1:10057121-10058108   -1.8906351 -2.2961952 -0.7416368 -2.7446878
##                          GSM1183459 GSM1183460 GSM1183461 GSM1183462
## chr1:10003165-10003585   -2.5928901 -2.3889526 -2.6460887 -2.7231261
## chr1:1002663-1005318     -0.0978623 -0.5153299 -0.1302912 -0.2164913
## chr1:100315420-100316009 -3.1202442 -3.1034921 -3.3016168 -3.4521085
## chr1:100435297-100436070 -2.3362214 -2.3185678 -2.5481766 -2.5349049
## chr1:100503482-100504404 -2.6162707 -2.3970941 -2.7532512 -2.7130206
## chr1:10057121-10058108   -2.2802288 -2.7551910 -2.5061829 -0.4842863
##                          GSM1183463 GSM1183464 GSM1183465 GSM1183466
## chr1:10003165-10003585   -2.5491017 -2.4576876 -2.6634236 -2.6269710
## chr1:1002663-1005318      0.1777277  0.2527131  0.1042947 -0.4701124
## chr1:100315420-100316009 -3.2860087 -3.2898758 -3.2739430 -3.3949594
## chr1:100435297-100436070 -2.4025642 -2.3717973 -2.2822308 -2.6972064
## chr1:100503482-100504404 -2.6531850 -2.6213044 -2.6589155 -2.8621837
## chr1:10057121-10058108   -1.7501278 -0.9031143 -1.4175589 -2.5515072
##                          GSM1183467 GSM1183468 GSM1183469 GSM1183470
## chr1:10003165-10003585   -2.5975998 -2.5412295 -2.4850925 -2.4145797
## chr1:1002663-1005318     -0.1106584 -0.3974871 -0.1186928 -0.4646606
## chr1:100315420-100316009 -3.3165319 -3.2531491 -3.0885286 -3.3201661
## chr1:100435297-100436070 -2.7201684 -2.6577729 -2.6383212 -2.6271861
## chr1:100503482-100504404 -2.7140042 -2.6688105 -2.6891018 -2.5954421
## chr1:10057121-10058108   -1.9689749 -2.1921074 -2.1734550 -2.1911826
##                          GSM1183471 GSM1183472  GSM1183473 GSM1183474
## chr1:10003165-10003585   -2.5213979  -2.466313 -2.55134704 -2.4765215
## chr1:1002663-1005318     -0.2727839  -0.204244  0.04854337 -0.3592211
## chr1:100315420-100316009 -3.2953992  -3.218619 -3.28942467 -3.4000418
## chr1:100435297-100436070 -2.5079133  -2.562802 -2.69858064 -2.6323302
## chr1:100503482-100504404 -2.6814858  -2.463127 -2.67413839 -2.8827299
## chr1:10057121-10058108   -1.9749580  -2.118518 -1.98687058 -1.6137291
##                          GSM1183475 GSM1183476 GSM1183477 GSM1183478
## chr1:10003165-10003585   -2.5553456 -2.5007390 -2.5346772 -2.5382355
## chr1:1002663-1005318     -0.2639951 -0.3881833 -0.1877652 -0.2008505
## chr1:100315420-100316009 -3.3787453 -3.3049143 -3.2620533 -3.2547827
## chr1:100435297-100436070 -2.6092785 -2.6791712 -2.6729198 -2.6679753
## chr1:100503482-100504404 -2.7651728 -2.7097997 -2.7011483 -2.6685389
## chr1:10057121-10058108   -1.9800005 -2.2907397 -1.6842134 -2.2742424
##                           GSM1183479 GSM1183480 GSM1183481 GSM1183482
## chr1:10003165-10003585   -2.78934539 -2.4393726  -2.470685 -2.4599626
## chr1:1002663-1005318      0.03098998 -0.3446402  -0.356047 -0.2735848
## chr1:100315420-100316009 -3.22150296 -3.2752470  -3.283137 -3.2123623
## chr1:100435297-100436070 -2.49583434 -2.6676062  -2.679606 -2.6550079
## chr1:100503482-100504404 -2.66726367 -2.8328728  -2.624475 -2.7429252
## chr1:10057121-10058108   -1.90776652 -2.5284930  -2.390040 -2.4086346
##                          GSM1183483  GSM1183484 GSM1183485 GSM1183486
## chr1:10003165-10003585   -2.6406160 -2.70045313 -2.7033185 -2.6432762
## chr1:1002663-1005318      0.1419676  0.02287766 -0.2400202 -0.0466823
## chr1:100315420-100316009 -3.2889347 -3.48242760 -3.2918360 -3.3131523
## chr1:100435297-100436070 -2.4959864 -2.78518605 -2.5886347 -2.5103397
## chr1:100503482-100504404 -2.8480882 -2.70227145 -2.8255920 -2.5938201
## chr1:10057121-10058108   -2.1335111 -2.58234107 -1.7365505 -2.1008323
##                          GSM1183487 GSM1183488 GSM1183489 GSM1183490
## chr1:10003165-10003585   -2.1723282 -2.4762976 -2.7209445 -2.6450045
## chr1:1002663-1005318      0.3671142 -0.2484297  0.1206241  0.1053612
## chr1:100315420-100316009 -2.8700148 -3.1976002 -3.0185030 -2.9115272
## chr1:100435297-100436070 -2.0898900 -2.6466377 -2.3003844 -2.3822229
## chr1:100503482-100504404 -2.3997197 -2.7176038 -2.5165885 -2.6060197
## chr1:10057121-10058108   -1.7340586 -2.0591488 -2.0783172 -1.6675826
##                          GSM1183491 GSM1183492 GSM1183493 GSM1183494
## chr1:10003165-10003585   -2.6654612 -2.3219709 -2.4483201 -2.5511022
## chr1:1002663-1005318      0.3462601  0.4469207  0.1254926 -0.5048053
## chr1:100315420-100316009 -3.1088263 -2.9417798 -3.4914174 -3.3202710
## chr1:100435297-100436070 -2.3348525 -2.0809495 -2.4237925 -2.4554246
## chr1:100503482-100504404 -2.6348955 -2.4477740 -2.7663400 -2.9570593
## chr1:10057121-10058108   -2.0751118 -1.8962422 -1.7759178 -2.1877155
##                           GSM1183495  GSM1183496  GSM1183497  GSM1183498
## chr1:10003165-10003585   -2.63486408 -2.48162177 -2.47640016 -2.58026479
## chr1:1002663-1005318     -0.06303079 -0.02946225 -0.09298967 -0.08300383
## chr1:100315420-100316009 -3.30801504 -3.18349564 -3.32868542 -3.30487740
## chr1:100435297-100436070 -2.55596834 -2.52263929 -2.71459787 -2.58571296
## chr1:100503482-100504404 -2.68080449 -2.76371740 -2.82548106 -2.97470935
## chr1:10057121-10058108   -1.83718920 -2.17762440 -2.30781157 -2.10909408
##                           GSM1183499 GSM1183500 GSM1183501 GSM1183502
## chr1:10003165-10003585   -2.63209567 -2.4744933 -2.4949798 -2.5833351
## chr1:1002663-1005318     -0.03106036 -0.3583119 -0.3324479 -0.2687182
## chr1:100315420-100316009 -3.34801905 -3.3203624 -3.2989031 -3.2702818
## chr1:100435297-100436070 -2.73638456 -2.6032170 -2.6614142 -2.7622146
## chr1:100503482-100504404 -2.73326044 -2.7836071 -2.6894563 -2.7985445
## chr1:10057121-10058108   -2.27761366 -2.0391860 -2.5430220 -2.3298607
##                          GSM1183503 GSM1183504 GSM1183505 GSM1183506
## chr1:10003165-10003585   -2.3760920 -2.5018222 -2.5406260 -2.6798983
## chr1:1002663-1005318     -0.5727622 -0.5142741 -0.3024174 -0.7474327
## chr1:100315420-100316009 -3.5542411 -3.2108034 -3.3840248 -3.5504974
## chr1:100435297-100436070 -2.6699468 -2.6373828 -2.6761145 -2.9711555
## chr1:100503482-100504404 -2.6357915 -2.6687809 -2.7204119 -2.8171362
## chr1:10057121-10058108   -2.4608661 -2.5729041 -2.3695044 -2.8156203
##                          GSM1183507 GSM1183508 GSM1183509 GSM1183510
## chr1:10003165-10003585   -2.4892827 -2.8071124 -2.6441459 -2.5450091
## chr1:1002663-1005318     -0.6555263 -0.6368511 -0.5938308 -0.5133373
## chr1:100315420-100316009 -3.5385598 -3.6574768 -3.4092673 -3.3552417
## chr1:100435297-100436070 -3.0219965 -3.0268029 -2.7734492 -2.6306042
## chr1:100503482-100504404 -2.8428973 -2.8916099 -2.7695231 -2.5695898
## chr1:10057121-10058108   -2.5254960 -2.3954471 -2.8763173 -2.8564190
##                          GSM1183511 GSM1183512 GSM1183513   GSM1183514
## chr1:10003165-10003585   -2.3345401 -2.4611793 -2.5232826 -2.794565724
## chr1:1002663-1005318     -0.5646612 -0.6593965 -0.3996432 -0.893026075
## chr1:100315420-100316009 -3.3974549 -3.4518730 -3.3672605 -3.590974285
## chr1:100435297-100436070 -2.6486824 -3.0160474 -2.5688085 -2.871634800
## chr1:100503482-100504404 -2.8023253 -2.8171447 -2.6757521 -2.839093719
## chr1:10057121-10058108   -2.1076040 -2.8274641 -2.5582427 -0.004961779
##                          GSM1183515 GSM1183516  GSM1183517 GSM1183518
## chr1:10003165-10003585   -2.5574941 -2.4817320 -2.70980738 -2.4192976
## chr1:1002663-1005318      0.1908337 -0.3539109 -1.25742650 -0.2876498
## chr1:100315420-100316009 -3.1601333 -3.3948670 -3.39826153 -3.1621329
## chr1:100435297-100436070 -2.6326338 -2.8575446 -2.81982492 -2.5290203
## chr1:100503482-100504404 -2.7675520 -2.7245740 -2.86439386 -2.5466905
## chr1:10057121-10058108   -2.7167976 -2.4120587  0.02238012 -2.2057753
##                          GSM1183519 GSM1183520 GSM1183521 GSM1183522
## chr1:10003165-10003585   -2.8827217  -2.516365 -2.4537406 -2.6946777
## chr1:1002663-1005318     -0.3800922   0.487411 -0.1899291 -0.6922016
## chr1:100315420-100316009 -3.4278863  -3.180156 -3.3113328 -3.2982204
## chr1:100435297-100436070 -2.7879821  -2.160308 -2.7512474 -2.8967630
## chr1:100503482-100504404 -2.5341330  -2.466457 -2.7391940 -2.9843558
## chr1:10057121-10058108   -2.7943131  -1.627597 -2.6084962 -2.7768410
##                          GSM1183523 GSM1183524 GSM1183525 GSM1183526
## chr1:10003165-10003585   -2.4622112 -2.5451917 -2.6681450 -2.8270665
## chr1:1002663-1005318     -0.3450193 -0.4116018  0.1524643 -0.9742143
## chr1:100315420-100316009 -3.5347077 -3.3356859 -3.2475622 -3.6032944
## chr1:100435297-100436070 -2.7015844 -2.6075023 -2.4573471 -2.9766122
## chr1:100503482-100504404 -2.7011248 -2.5565389 -2.7428883 -2.8149033
## chr1:10057121-10058108   -2.3584792 -2.3597911 -1.9721684 -3.0843057
##                          GSM1183527  GSM1183528 GSM1183529  GSM1183530
## chr1:10003165-10003585    -2.715084 -2.51442884 -2.5722132 -2.51044935
## chr1:1002663-1005318      -1.052124 -0.07902266 -0.1090344 -0.08058042
## chr1:100315420-100316009  -3.577829 -3.25446329 -3.3411582 -3.40226436
## chr1:100435297-100436070  -3.096443 -2.51894210 -2.5145817 -2.78800177
## chr1:100503482-100504404  -2.786104 -2.52975089 -2.6832643 -2.61647446
## chr1:10057121-10058108    -2.856401 -2.35051733 -2.0999465 -2.45045802
##                          GSM1183531 GSM1183532 GSM1183533 GSM1183534
## chr1:10003165-10003585   -2.5230189 -2.4772421 -2.5054475 -2.5991168
## chr1:1002663-1005318     -0.7695092 -0.9591101 -0.5369419 -0.5766602
## chr1:100315420-100316009 -3.3759884 -3.5681969 -3.2956107 -3.3664893
## chr1:100435297-100436070 -2.7818569 -2.8156503 -2.5494621 -2.6290269
## chr1:100503482-100504404 -2.6662381 -2.7690945 -2.5586073 -2.7199332
## chr1:10057121-10058108   -2.6505661 -2.6469958 -2.2942003 -2.6646535
##                          GSM1183535 GSM1183536 GSM1183537 GSM1183538
## chr1:10003165-10003585    -2.363892  -2.666929  -2.616571 -2.5416443
## chr1:1002663-1005318      -0.154614  -1.045520  -1.254954 -0.8628501
## chr1:100315420-100316009  -3.383797  -3.531605  -3.549230 -3.4468167
## chr1:100435297-100436070  -2.777329  -2.977179  -2.886160 -2.7070430
## chr1:100503482-100504404  -2.684621  -2.946696  -2.937330 -2.7255946
## chr1:10057121-10058108    -2.439123  -1.864672  -2.005083 -2.9946131
##                          GSM1183539 GSM1183540 GSM1183541 GSM1183542
## chr1:10003165-10003585   -2.8752842 -2.4306625 -2.5951367  -2.676305
## chr1:1002663-1005318     -0.5308050  0.2092777 -0.1439707  -1.074767
## chr1:100315420-100316009 -3.5223805 -3.2474810 -3.1633167  -3.499562
## chr1:100435297-100436070 -2.7828174 -2.6042976 -2.3120103  -2.978451
## chr1:100503482-100504404 -2.9606268 -2.6586909 -2.6340278  -3.017156
## chr1:10057121-10058108   -0.8160312 -1.7308273 -2.5610825  -2.911221
##                          GSM1183543  GSM1183544 GSM1183545 GSM1183546
## chr1:10003165-10003585   -2.4328712 -2.68895993 -2.4035817 -2.7173873
## chr1:1002663-1005318     -0.5943623 -0.04813778  0.3884715 -0.3234209
## chr1:100315420-100316009 -3.3082008 -3.19362168 -3.1150482 -3.4909309
## chr1:100435297-100436070 -2.7679585 -2.45400458 -2.1515453 -2.6983911
## chr1:100503482-100504404 -2.5032138 -2.69788563 -2.6480267 -2.9672095
## chr1:10057121-10058108   -2.8442728 -1.89665624 -1.8706002 -2.0210757
##                          GSM1183547  GSM1183548 GSM1183549 GSM1183550
## chr1:10003165-10003585   -2.4708077 -2.67047241  -2.873039  -2.902766
## chr1:1002663-1005318     -0.1919004 -0.05228926  -1.225704  -1.020126
## chr1:100315420-100316009 -3.4013430 -3.30489431  -3.534048  -3.648111
## chr1:100435297-100436070 -2.6156074 -2.37281582  -3.085966  -2.986475
## chr1:100503482-100504404 -2.7828367 -2.67066895  -3.019369  -2.945886
## chr1:10057121-10058108   -2.2382613 -2.38875900  -2.206652  -2.058766
##                          GSM1183551 GSM1183552 GSM1183553  GSM1183554
## chr1:10003165-10003585   -2.6086813 -2.2954377 -2.4534002 -2.59945570
## chr1:1002663-1005318     -0.4032427  0.3948961  0.1173246  0.01771181
## chr1:100315420-100316009 -3.4765112 -3.0633456 -3.2935863 -3.26522873
## chr1:100435297-100436070 -2.6783351 -2.0686436 -2.4689794 -2.49531811
## chr1:100503482-100504404 -2.9638341 -2.4317759 -2.6365286 -2.67921463
## chr1:10057121-10058108   -2.3911001 -2.0523751 -1.7506630 -2.19764846
##                          GSM1183555  GSM1183556 GSM1183557   GSM1183558
## chr1:10003165-10003585   -2.7170612 -2.47360455 -2.7437807 -2.793726717
## chr1:1002663-1005318      0.0363121  0.02016923 -0.5060306 -1.417894319
## chr1:100315420-100316009 -3.5089492 -3.36980796 -3.3420403 -3.535314747
## chr1:100435297-100436070 -2.5036881 -2.75306404 -2.7442860 -3.275508203
## chr1:100503482-100504404 -2.6449797 -2.76934714 -2.6517998 -2.940411823
## chr1:10057121-10058108   -2.1389980 -2.56401695 -2.8584225 -0.001879325
##                           GSM1183559 GSM1183560 GSM1183561 GSM1235135
## chr1:10003165-10003585   -2.57914633 -2.8330552 -2.7309010 -2.6811757
## chr1:1002663-1005318     -0.04596533 -1.1547271 -0.8737399 -0.8261102
## chr1:100315420-100316009 -3.32159900 -3.7492971 -3.5794866 -3.4431519
## chr1:100435297-100436070 -2.52344354 -2.9957279 -2.7698383 -2.7759642
## chr1:100503482-100504404 -2.64300275 -3.0614550 -2.7066204 -2.8489858
## chr1:10057121-10058108   -1.96268277 -0.5575545 -1.7797307 -2.4014718
##                          GSM1235136 GSM1235137 GSM1235138 GSM1235139
## chr1:10003165-10003585   -2.6477766  -2.702564 -2.8023263 -2.4478487
## chr1:1002663-1005318     -0.3844503  -0.483281 -0.8482104 -0.3493395
## chr1:100315420-100316009 -3.4730226  -3.451509 -3.5055528 -3.3486040
## chr1:100435297-100436070 -2.7160374  -2.808582 -2.9682315 -2.6851538
## chr1:100503482-100504404 -2.8288185  -2.773447 -2.8228641 -2.7326488
## chr1:10057121-10058108   -1.7369457  -2.186193 -2.3280194 -2.2730317
##                          GSM1235140 GSM1235141 GSM1235142  GSM1235143
## chr1:10003165-10003585    -2.828660  -2.676493  -2.692334 -2.90152090
## chr1:1002663-1005318      -1.018976  -0.542397  -0.819848 -0.03415505
## chr1:100315420-100316009  -3.536803  -3.498916  -3.517102 -3.66291211
## chr1:100435297-100436070  -2.844221  -2.951094  -2.949362 -2.93604861
## chr1:100503482-100504404  -2.736433  -2.908117  -2.776179 -3.05398469
## chr1:10057121-10058108    -2.728394  -2.462111  -2.916486 -2.08641546
##                          GSM1235144 GSM1235145 GSM1235146 GSM1235147
## chr1:10003165-10003585    -2.862507 -2.5671695 -2.7707534 -2.6113458
## chr1:1002663-1005318      -1.429965 -0.3208506 -0.6404117 -0.7149859
## chr1:100315420-100316009  -3.735792 -3.5761870 -3.6200129 -3.4897598
## chr1:100435297-100436070  -3.105051 -2.6148847 -2.7674711 -2.5894137
## chr1:100503482-100504404  -2.908989 -2.8832492 -2.9253187 -2.7715724
## chr1:10057121-10058108    -1.103073 -2.0376414 -2.7294505 -2.3116782
##                          GSM1235148 GSM1235149 GSM1235150 GSM1235151
## chr1:10003165-10003585    -2.794790 -2.5643987  -2.626196 -2.3914945
## chr1:1002663-1005318      -0.195880 -0.8946123  -0.499279 -0.3712183
## chr1:100315420-100316009  -3.571170 -3.4136682  -3.344802 -3.6347130
## chr1:100435297-100436070  -2.791283 -2.8516547  -2.659318 -2.8817924
## chr1:100503482-100504404  -2.864650 -2.8154332  -2.801233 -2.7130548
## chr1:10057121-10058108    -2.507433 -2.3902709  -2.394794 -2.2583082
##                          GSM1235152 GSM1235153 GSM1235154 GSM1235155
## chr1:10003165-10003585   -2.6829868 -2.5431050 -2.6734087 -2.8229434
## chr1:1002663-1005318     -0.6720619 -0.3095247 -0.3535083 -0.9630747
## chr1:100315420-100316009 -3.6281184 -3.3301228 -3.3366841 -3.2905880
## chr1:100435297-100436070 -2.9513623 -2.6508038 -2.9213792 -2.8662826
## chr1:100503482-100504404 -2.7519088 -2.7644744 -2.8670847 -2.9335138
## chr1:10057121-10058108   -2.9960025 -2.3454842 -2.5402733 -2.8436313
##                          GSM1235156 GSM1235157 GSM1235158
## chr1:10003165-10003585   -2.5337367  -2.632813  -2.607099
## chr1:1002663-1005318     -0.6739876  -1.352517  -1.108535
## chr1:100315420-100316009 -3.4911129  -3.388591  -3.493868
## chr1:100435297-100436070 -2.6590959  -3.047235  -3.056798
## chr1:100503482-100504404 -2.7005638  -2.850698  -2.891250
## chr1:10057121-10058108   -2.5902250  -3.121232  -2.849576
```

```r
head(metadata)
```

```
##               group                                title geo_accession
## GSM1183439 normal-H Genomic DNA from normal individual 1    GSM1183439
## GSM1183440 normal-H Genomic DNA from normal individual 2    GSM1183440
## GSM1183441 normal-H Genomic DNA from normal individual 3    GSM1183441
## GSM1183442 normal-H Genomic DNA from normal individual 4    GSM1183442
## GSM1183443 normal-H Genomic DNA from normal individual 5    GSM1183443
## GSM1183444 normal-H Genomic DNA from normal individual 6    GSM1183444
##                       tissue colon_region gender stage
## GSM1183439 colorectal mucosa        colon   male  <NA>
## GSM1183440 colorectal mucosa        colon   male  <NA>
## GSM1183441 colorectal mucosa        colon female  <NA>
## GSM1183442 colorectal mucosa        colon   male  <NA>
## GSM1183443 colorectal mucosa        colon   male  <NA>
## GSM1183444 colorectal mucosa        colon   male  <NA>
```

```r
# function to perform limma to generate top table
limmaTopTables <- function(dat, des, file_name){
	myFit <- lmFit(dat, des)
	myEbFit <- eBayes(myFit)
	
	for (coeff in colnames(myEbFit$coefficients)[-1]){
		myTopTable <- topTable(myEbFit, number=nrow(dat), coef=c(coeff))
		
		save(myTopTable, file=file_name)
	}
}

# reorder factor level for `group`
metadata$group <- factor(metadata$group, levels=c("normal-H", "normal-C", "cancer", "adenoma"))
```



Subset the data and only keep normal-C and normal-H groups.
The design matrix is built only by normal-C and normal-H

```r
goal <- "Normal-C_vs_Normal-H"
group_names <- c("normal-H","normal-C")

# design matrix for limma on group
des <- metadata[which(metadata$group %in% group_names), ] %>% droplevels()
desMat.group <- model.matrix(~group, des)
desMat.group
```

```
##            (Intercept) groupnormal-C
## GSM1183439           1             0
## GSM1183440           1             0
## GSM1183441           1             0
## GSM1183442           1             0
## GSM1183443           1             0
## GSM1183444           1             0
## GSM1183467           1             0
## GSM1183468           1             0
## GSM1183469           1             0
## GSM1183470           1             0
## GSM1183471           1             0
## GSM1183472           1             0
## GSM1183473           1             0
## GSM1183474           1             0
## GSM1183475           1             0
## GSM1183476           1             0
## GSM1183477           1             0
## GSM1183478           1             1
## GSM1183479           1             1
## GSM1183480           1             1
## GSM1183481           1             1
## GSM1183482           1             1
## GSM1183483           1             1
## GSM1183484           1             1
## GSM1183485           1             1
## GSM1183486           1             1
## GSM1183487           1             1
## GSM1183488           1             1
## GSM1183489           1             1
## GSM1183490           1             1
## GSM1183491           1             1
## GSM1183492           1             1
## GSM1183493           1             1
## GSM1183494           1             1
## GSM1183495           1             1
## GSM1183496           1             1
## GSM1183497           1             1
## GSM1183498           1             1
## GSM1183499           1             1
## GSM1183500           1             1
## GSM1183501           1             1
## attr(,"assign")
## [1] 0 1
## attr(,"contrasts")
## attr(,"contrasts")$group
## [1] "contr.treatment"
```

```r
group_subset <- as.character(metadata$geo_accession
														 [which(metadata$group %in% group_names)])
group_subset
```

```
##  [1] "GSM1183439" "GSM1183440" "GSM1183441" "GSM1183442" "GSM1183443"
##  [6] "GSM1183444" "GSM1183467" "GSM1183468" "GSM1183469" "GSM1183470"
## [11] "GSM1183471" "GSM1183472" "GSM1183473" "GSM1183474" "GSM1183475"
## [16] "GSM1183476" "GSM1183477" "GSM1183478" "GSM1183479" "GSM1183480"
## [21] "GSM1183481" "GSM1183482" "GSM1183483" "GSM1183484" "GSM1183485"
## [26] "GSM1183486" "GSM1183487" "GSM1183488" "GSM1183489" "GSM1183490"
## [31] "GSM1183491" "GSM1183492" "GSM1183493" "GSM1183494" "GSM1183495"
## [36] "GSM1183496" "GSM1183497" "GSM1183498" "GSM1183499" "GSM1183500"
## [41] "GSM1183501"
```

```r
length(group_subset)
```

```
## [1] 41
```

```r
dat <- M.norm.CGI[, group_subset] %>% droplevels()

head(dat)
```

```
##                          GSM1183439  GSM1183440 GSM1183441 GSM1183442
## chr1:10003165-10003585   -2.6552923 -2.59856415 -2.5445386 -2.5589572
## chr1:1002663-1005318     -0.4691256 -0.09143954 -0.2533638 -0.2153825
## chr1:100315420-100316009 -3.2051837 -3.28066606 -3.1908783 -3.3171275
## chr1:100435297-100436070 -2.6509063 -2.53842308 -2.3740902 -2.6930074
## chr1:100503482-100504404 -2.5912106 -2.61793251 -2.5333289 -2.6985588
## chr1:10057121-10058108   -1.8793069 -1.60397303 -1.9452079 -1.4107345
##                           GSM1183443 GSM1183444 GSM1183467 GSM1183468
## chr1:10003165-10003585   -2.55737653 -2.5826043 -2.5975998 -2.5412295
## chr1:1002663-1005318     -0.09556418 -0.1394251 -0.1106584 -0.3974871
## chr1:100315420-100316009 -3.44138495 -3.2638314 -3.3165319 -3.2531491
## chr1:100435297-100436070 -2.58548225 -2.6448828 -2.7201684 -2.6577729
## chr1:100503482-100504404 -2.77076081 -2.7414266 -2.7140042 -2.6688105
## chr1:10057121-10058108   -1.89517507 -2.1822275 -1.9689749 -2.1921074
##                          GSM1183469 GSM1183470 GSM1183471 GSM1183472
## chr1:10003165-10003585   -2.4850925 -2.4145797 -2.5213979  -2.466313
## chr1:1002663-1005318     -0.1186928 -0.4646606 -0.2727839  -0.204244
## chr1:100315420-100316009 -3.0885286 -3.3201661 -3.2953992  -3.218619
## chr1:100435297-100436070 -2.6383212 -2.6271861 -2.5079133  -2.562802
## chr1:100503482-100504404 -2.6891018 -2.5954421 -2.6814858  -2.463127
## chr1:10057121-10058108   -2.1734550 -2.1911826 -1.9749580  -2.118518
##                           GSM1183473 GSM1183474 GSM1183475 GSM1183476
## chr1:10003165-10003585   -2.55134704 -2.4765215 -2.5553456 -2.5007390
## chr1:1002663-1005318      0.04854337 -0.3592211 -0.2639951 -0.3881833
## chr1:100315420-100316009 -3.28942467 -3.4000418 -3.3787453 -3.3049143
## chr1:100435297-100436070 -2.69858064 -2.6323302 -2.6092785 -2.6791712
## chr1:100503482-100504404 -2.67413839 -2.8827299 -2.7651728 -2.7097997
## chr1:10057121-10058108   -1.98687058 -1.6137291 -1.9800005 -2.2907397
##                          GSM1183477 GSM1183478  GSM1183479 GSM1183480
## chr1:10003165-10003585   -2.5346772 -2.5382355 -2.78934539 -2.4393726
## chr1:1002663-1005318     -0.1877652 -0.2008505  0.03098998 -0.3446402
## chr1:100315420-100316009 -3.2620533 -3.2547827 -3.22150296 -3.2752470
## chr1:100435297-100436070 -2.6729198 -2.6679753 -2.49583434 -2.6676062
## chr1:100503482-100504404 -2.7011483 -2.6685389 -2.66726367 -2.8328728
## chr1:10057121-10058108   -1.6842134 -2.2742424 -1.90776652 -2.5284930
##                          GSM1183481 GSM1183482 GSM1183483  GSM1183484
## chr1:10003165-10003585    -2.470685 -2.4599626 -2.6406160 -2.70045313
## chr1:1002663-1005318      -0.356047 -0.2735848  0.1419676  0.02287766
## chr1:100315420-100316009  -3.283137 -3.2123623 -3.2889347 -3.48242760
## chr1:100435297-100436070  -2.679606 -2.6550079 -2.4959864 -2.78518605
## chr1:100503482-100504404  -2.624475 -2.7429252 -2.8480882 -2.70227145
## chr1:10057121-10058108    -2.390040 -2.4086346 -2.1335111 -2.58234107
##                          GSM1183485 GSM1183486 GSM1183487 GSM1183488
## chr1:10003165-10003585   -2.7033185 -2.6432762 -2.1723282 -2.4762976
## chr1:1002663-1005318     -0.2400202 -0.0466823  0.3671142 -0.2484297
## chr1:100315420-100316009 -3.2918360 -3.3131523 -2.8700148 -3.1976002
## chr1:100435297-100436070 -2.5886347 -2.5103397 -2.0898900 -2.6466377
## chr1:100503482-100504404 -2.8255920 -2.5938201 -2.3997197 -2.7176038
## chr1:10057121-10058108   -1.7365505 -2.1008323 -1.7340586 -2.0591488
##                          GSM1183489 GSM1183490 GSM1183491 GSM1183492
## chr1:10003165-10003585   -2.7209445 -2.6450045 -2.6654612 -2.3219709
## chr1:1002663-1005318      0.1206241  0.1053612  0.3462601  0.4469207
## chr1:100315420-100316009 -3.0185030 -2.9115272 -3.1088263 -2.9417798
## chr1:100435297-100436070 -2.3003844 -2.3822229 -2.3348525 -2.0809495
## chr1:100503482-100504404 -2.5165885 -2.6060197 -2.6348955 -2.4477740
## chr1:10057121-10058108   -2.0783172 -1.6675826 -2.0751118 -1.8962422
##                          GSM1183493 GSM1183494  GSM1183495  GSM1183496
## chr1:10003165-10003585   -2.4483201 -2.5511022 -2.63486408 -2.48162177
## chr1:1002663-1005318      0.1254926 -0.5048053 -0.06303079 -0.02946225
## chr1:100315420-100316009 -3.4914174 -3.3202710 -3.30801504 -3.18349564
## chr1:100435297-100436070 -2.4237925 -2.4554246 -2.55596834 -2.52263929
## chr1:100503482-100504404 -2.7663400 -2.9570593 -2.68080449 -2.76371740
## chr1:10057121-10058108   -1.7759178 -2.1877155 -1.83718920 -2.17762440
##                           GSM1183497  GSM1183498  GSM1183499 GSM1183500
## chr1:10003165-10003585   -2.47640016 -2.58026479 -2.63209567 -2.4744933
## chr1:1002663-1005318     -0.09298967 -0.08300383 -0.03106036 -0.3583119
## chr1:100315420-100316009 -3.32868542 -3.30487740 -3.34801905 -3.3203624
## chr1:100435297-100436070 -2.71459787 -2.58571296 -2.73638456 -2.6032170
## chr1:100503482-100504404 -2.82548106 -2.97470935 -2.73326044 -2.7836071
## chr1:10057121-10058108   -2.30781157 -2.10909408 -2.27761366 -2.0391860
##                          GSM1183501
## chr1:10003165-10003585   -2.4949798
## chr1:1002663-1005318     -0.3324479
## chr1:100315420-100316009 -3.2989031
## chr1:100435297-100436070 -2.6614142
## chr1:100503482-100504404 -2.6894563
## chr1:10057121-10058108   -2.5430220
```

```r
ncol(dat)
```

```
## [1] 41
```

```r
file_name <- paste0("../../data/limma/topTable_", goal, ".Rdata")
limmaTopTables(dat, desMat.group, file_name)

load(file_name)

head(myTopTable)
```

```
##                               logFC    AveExpr         t      P.Value
## chr16:19127121-19127324   0.4440572  2.2939335  8.775044 4.537026e-11
## chr2:220406363-220406840 -0.8258975 -1.6398629 -8.509233 1.051259e-10
## chr8:80695830-80696458   -0.5318991 -0.5872997 -8.117659 3.674980e-10
## chr2:241185136-241185374  0.3151391  3.0081231  7.614408 1.875893e-09
## chr16:88953219-88953445   0.4671165  2.5608583  7.081584 1.077177e-08
## chr1:228565949-228567121 -0.3429617 -0.8504179 -7.006169 1.381524e-08
##                             adj.P.Val         B
## chr16:19127121-19127324  1.196096e-06 14.651225
## chr2:220406363-220406840 1.385717e-06 13.894556
## chr8:80695830-80696458   3.229450e-06 12.762765
## chr2:241185136-241185374 1.236354e-05 11.280801
## chr16:88953219-88953445  5.466333e-05  9.683236
## chr1:228565949-228567121 5.466333e-05  9.455156
```




```r
## plot density
ggplot(myTopTable, aes(adj.P.Val)) + 
	stat_density(geom = "line", position = "identity") +
	ggtitle("FDR density")
```

![](04.1limma-normal-C_vs_normal-H_files/figure-html/density_plot-1.png) 

```r
ggplot(myTopTable, aes(adj.P.Val)) + 
	geom_histogram(position="identity") +
	ggtitle("FDR density")
```

```
## stat_bin: binwidth defaulted to range/30. Use 'binwidth = x' to adjust this.
```

![](04.1limma-normal-C_vs_normal-H_files/figure-html/density_plot-2.png) 


Setting cutoffs


```r
cutoff <- 1e-3
length(which(myTopTable$adj.P.Val < cutoff))
```

```
## [1] 50
```




```r
top <- length(which(myTopTable$adj.P.Val < cutoff))
top_genes <-as.character(rownames(myTopTable)[1:top]) 
head(top_genes)
```

```
## [1] "chr16:19127121-19127324"  "chr2:220406363-220406840"
## [3] "chr8:80695830-80696458"   "chr2:241185136-241185374"
## [5] "chr16:88953219-88953445"  "chr1:228565949-228567121"
```

```r
top_matrix <- subsetData(M.norm.CGI, top_genes, design = metadata)

#subset to the groups
top_matrix <- top_matrix[, group_subset]
head(top_matrix)	
```

```
##                           GSM1183439 GSM1183440 GSM1183441 GSM1183442
## chr1:228565949-228567121  -0.5322171 -0.3870092 -0.4286015 -0.6197283
## chr1:46216233-46216514    -2.4597238 -2.4905294 -2.3758004 -2.5122584
## chr10:126303794-126304213  2.7772680  2.6913844  2.7815182  2.6652670
## chr10:128993505-128995167 -0.2644975 -0.3401450 -0.5760275 -0.2179550
## chr10:391382-394008        3.4814508  3.9398029  3.6702770  3.4840112
## chr11:121028572-121028927  3.4919793  3.6378976  3.6303876  3.6485478
##                           GSM1183443 GSM1183444 GSM1183467 GSM1183468
## chr1:228565949-228567121  -0.5223738 -0.4656893 -0.5926917 -0.7472674
## chr1:46216233-46216514    -2.6035862 -2.4580658 -2.4023983 -2.4156946
## chr10:126303794-126304213  2.8139438  2.8535744  2.5756215  2.7372688
## chr10:128993505-128995167 -0.5787903 -0.4637884 -0.8328442 -0.9772025
## chr10:391382-394008        3.9607866  3.4432732  3.5040302  3.4328778
## chr11:121028572-121028927  3.5728913  3.6950954  3.5139617  3.4359206
##                           GSM1183469 GSM1183470 GSM1183471 GSM1183472
## chr1:228565949-228567121  -0.8418265 -0.7706155 -0.6620103 -0.9786747
## chr1:46216233-46216514    -2.2928918 -2.2793676 -2.2987603 -2.4566554
## chr10:126303794-126304213  2.6082933  2.6892605  2.5714453  2.5873660
## chr10:128993505-128995167 -0.8292225 -0.7753803 -0.8454697 -0.8788686
## chr10:391382-394008        3.6472798  3.4849649  3.5113381  3.3584418
## chr11:121028572-121028927  3.5385856  3.6004495  3.2802961  3.4750793
##                           GSM1183473 GSM1183474 GSM1183475 GSM1183476
## chr1:228565949-228567121  -0.5889498 -0.6084333 -0.7722962 -0.8252880
## chr1:46216233-46216514    -2.4542915 -2.4334873 -2.3573556 -2.4265818
## chr10:126303794-126304213  2.6718374  2.5899466  2.5188711  2.6913947
## chr10:128993505-128995167 -0.7491793 -0.6629075 -0.8587453 -0.8908507
## chr10:391382-394008        3.3091754  3.3784168  3.4300091  3.4044699
## chr11:121028572-121028927  3.5083088  3.4879806  3.3913602  3.4804464
##                           GSM1183477 GSM1183478 GSM1183479 GSM1183480
## chr1:228565949-228567121  -0.7005442  -1.114321 -0.8097132  -1.098641
## chr1:46216233-46216514    -2.4065921  -2.307704 -2.2832281  -2.186137
## chr10:126303794-126304213  2.6719462   2.451448  2.6390121   2.393752
## chr10:128993505-128995167 -0.6405318  -1.229366 -1.5613099  -1.214857
## chr10:391382-394008        3.3771302   3.047935  3.0281367   3.141626
## chr11:121028572-121028927  3.4818616   3.160586  3.3664274   3.123185
##                           GSM1183481 GSM1183482 GSM1183483 GSM1183484
## chr1:228565949-228567121  -0.9790564  -1.021832  -1.027075  -1.082940
## chr1:46216233-46216514    -2.3219423  -2.363690  -2.234742  -2.207169
## chr10:126303794-126304213  2.4186313   2.388194   2.422759   2.252589
## chr10:128993505-128995167 -1.3574898  -1.440338  -1.456879  -1.890456
## chr10:391382-394008        2.9430176   3.201441   3.040212   2.724008
## chr11:121028572-121028927  3.0580360   3.067181   3.244917   3.238674
##                           GSM1183485 GSM1183486 GSM1183487 GSM1183488
## chr1:228565949-228567121  -0.9290582 -0.8478649 -0.9017903  -1.099944
## chr1:46216233-46216514    -2.3065694 -2.1974205 -2.2632667  -2.138136
## chr10:126303794-126304213  2.6123520  2.5559442  2.1530148   2.474482
## chr10:128993505-128995167 -0.6905444 -1.4493600 -2.1154963  -1.294025
## chr10:391382-394008        2.8863300  3.2829542  2.8326469   3.049641
## chr11:121028572-121028927  3.3314756  3.2935143  3.1514569   3.036736
##                           GSM1183489 GSM1183490 GSM1183491 GSM1183492
## chr1:228565949-228567121   -1.011677 -0.8058278  -1.057769  -1.014937
## chr1:46216233-46216514     -2.194103 -2.0520461  -2.011901  -2.257358
## chr10:126303794-126304213   2.306879  2.2000626   2.386000   2.496592
## chr10:128993505-128995167  -1.417009 -0.8433600  -1.838112  -1.312429
## chr10:391382-394008         3.067826  3.2653258   2.538882   2.875362
## chr11:121028572-121028927   3.199715  2.9532656   3.263544   3.238719
##                           GSM1183493 GSM1183494 GSM1183495 GSM1183496
## chr1:228565949-228567121   -1.274461 -0.9658067 -0.9966069  -1.031839
## chr1:46216233-46216514     -2.268330 -2.2851087 -2.2463207  -2.383150
## chr10:126303794-126304213   2.478973  2.5134533  2.4766983   2.445583
## chr10:128993505-128995167  -1.051179 -0.8566379 -0.6603210  -1.242734
## chr10:391382-394008         3.261984  3.3773109  3.0790685   3.084617
## chr11:121028572-121028927   3.520334  3.3870882  3.4977619   3.303520
##                           GSM1183497 GSM1183498 GSM1183499 GSM1183500
## chr1:228565949-228567121   -0.749869 -0.8682032  -1.368759 -0.7376313
## chr1:46216233-46216514     -2.270700 -2.2264052  -2.331499 -2.2814676
## chr10:126303794-126304213   2.446921  2.4545073   2.530199  2.5699392
## chr10:128993505-128995167  -1.266471 -0.8969959  -1.308129 -0.7042934
## chr10:391382-394008         3.326970  3.3821303   3.382790  3.3145634
## chr11:121028572-121028927   3.323174  3.1903439   3.326959  3.4135408
##                           GSM1183501
## chr1:228565949-228567121   -1.027295
## chr1:46216233-46216514     -2.375468
## chr10:126303794-126304213   2.577239
## chr10:128993505-128995167  -1.134369
## chr10:391382-394008         3.502501
## chr11:121028572-121028927   3.313781
```

```r
ncol(top_matrix)
```

```
## [1] 41
```

```r
plotHeatmap(top_matrix, title = paste0("Heatmap of top ", top, "\n", goal),
						col_dendrogram = T, row_dendrogram = T)
```

![](04.1limma-normal-C_vs_normal-H_files/figure-html/heatmap-1.png) 
